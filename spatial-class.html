<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 La donnée géographique dans R | Geocomputation avec R</title>
<meta name="author" content="Robin Lovelace, Jakub Nowosad, Jannes Muenchow">
<meta name="description" content="Prérequis C’est le premier chapitre pratique du livre. Il faut donc installer certains logiciels et les avoir un peu pratiqué. Nous supposons que vous avez installé une version à jour de R et que...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 2 La donnée géographique dans R | Geocomputation avec R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://geocompr.github.io/fr/spatial-class.html">
<meta property="og:image" content="https://geocompr.github.io/es/images/cover.png">
<meta property="og:description" content="Prérequis C’est le premier chapitre pratique du livre. Il faut donc installer certains logiciels et les avoir un peu pratiqué. Nous supposons que vous avez installé une version à jour de R et que...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 La donnée géographique dans R | Geocomputation avec R">
<meta name="twitter:description" content="Prérequis C’est le premier chapitre pratique du livre. Il faut donc installer certains logiciels et les avoir un peu pratiqué. Nous supposons que vous avez installé une version à jour de R et que...">
<meta name="twitter:image" content="https://geocompr.github.io/es/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/_Lato-0.4.0/font.css" rel="stylesheet">
<link href="libs/_Roboto%20Mono-0.4.0/font.css" rel="stylesheet">
<link href="libs/_Montserrat-0.4.0/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">
<script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-99618359-1', 'auto');
      ga('send', 'pageview');

    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h2>
        <a href="index.html" title="">Geocomputation avec R</a>
      </h2>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bienvenue!</a></li>
<li><a class="" href="foreword-1st-edition.html">Foreword (1st Edition)</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li class="book-part">Foundations</li>
<li><a class="active" href="spatial-class.html"><span class="header-section-number">2</span> La donnée géographique dans R</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/geocompr/fr">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="spatial-class" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> La donnée géographique dans R<a class="anchor" aria-label="anchor" href="#spatial-class"><i class="fas fa-link"></i></a>
</h1>
<div id="prérequis" class="section level2 unnumbered">
<h2>Prérequis<a class="anchor" aria-label="anchor" href="#pr%C3%A9requis"><i class="fas fa-link"></i></a>
</h2>
<p>C’est le premier chapitre pratique du livre. Il faut donc installer certains logiciels et les avoir un peu pratiqué.
Nous supposons que vous avez installé une version à jour de R et que vous êtes à l’aise avec les logiciels dotés d’une interface de ligne de commande, comme l’environnement de développement intégré (IDE) RStudio.
<!--or VSCode?--></p>
<!-- Should we update these references to more up-to-date resources? -->
<p>Si vous débutez avec R, nous vous recommandons de lire le chapitre 2 du livre en ligne <em>Efficient R Programming</em> de <span class="citation">Gillespie and Lovelace (<a href="spatial-class.html#ref-gillespie_efficient_2016" role="doc-biblioref">2016</a>)</span> et d’apprendre les bases du langage en vous référant à des ressources telles que <span class="citation">Grolemund and Wickham (<a href="spatial-class.html#ref-grolemund_r_2016" role="doc-biblioref">2016</a>)</span>.
Organisez votre travail (par exemple, avec des projets RStudio) et donnez aux scripts des noms judicieux tels que <code>02-chapter.R</code> pour documenter le code que vous écrivez au fur et à mesure de votre apprentissage.
</p>
<p>Les paquets utilisés dans ce chapitre peuvent être installés à l’aide des commandes suivantes :<a href="spatial-class.html#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"sf"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"terra"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"spData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"spDataLarge"</span>, repos <span class="op">=</span> <span class="st">"https://nowosad.r-universe.dev"</span><span class="op">)</span></code></pre></div>


<div class="rmdnote">
Sur Mac ou Linux, la commande précédente d´installation de <strong>sf</strong> peut ne pas fonctionner du premier coup.
Ces systèmes d´exploitation (OS) ont une “configuration requise” décrite dans la notice du paquets.<a href="https://github.com/r-spatial/sf">README</a>.
Des instructions spécifiques pour chaque système d´exploitation sont disponibles en ligne, comme l´article <em>Installation de R 4.0 sur Ubuntu 20.04</em> sur le blog <a href="https://rtask.thinkr.fr/installation-of-r-4-0-on-ubuntu-20-04-lts-and-tips-for-spatial-packages/">rtask.thinkr.fr</a>.
</div>
<p>Tous les paquets nécessaires pour reproduire le contenu du livre peuvent être installés via la commande suivante : <code>remotes::install_github("geocompr/geocompkg")</code>.
Les paquets nécessaires peuvent être “chargés” (techniquement, ils sont attachés) avec la fonction <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> :</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>          <span class="co"># classes et fonctions pour les données vectorielles</span>
<span class="co">#&gt; Linking to GEOS 3.8.0, GDAL 3.0.4, PROJ 6.3.1; sf_use_s2() is TRUE</span></code></pre></div>
<p>Conformemant à la section <a href="#intro-sf"><strong>??</strong></a>, la sortie de <code><a href="https://r-spatial.github.io/sf/">library(sf)</a></code> mentionne les versions des bibliothèques géographiques clés, comme GEOS, utilisées par ce paquet.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/terra/">terra</a></span><span class="op">)</span>      <span class="co"># classes et fonctions pour les données rasters</span></code></pre></div>
<p>Les autres paquets installés contiennent des données qui seront utilisées dans le livre:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://nowosad.github.io/spData/">spData</a></span><span class="op">)</span>        <span class="co"># chargement de données geographiques</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Nowosad/spData">spDataLarge</a></span><span class="op">)</span>   <span class="co"># chargement de données geographiques plus volumineuses</span></code></pre></div>
</div>
<div id="intro-spatial-class" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Introduction<a class="anchor" aria-label="anchor" href="#intro-spatial-class"><i class="fas fa-link"></i></a>
</h2>
<p>Ce chapitre fournit de brèves explications sur les modèles fondamentaux des données géographiques : vecteur et raster.
Nous présenterons la théorie qui sous-tend chaque modèle de données et les disciplines dans lesquelles ils prédominent, avant de démontrer leur mise en œuvre dans R.</p>
<p>Le <em>modèle de données vectoriel</em> représente le monde à l’aide de points, de lignes et de polygones.
Ceux-ci ont des frontières discrètes et bien définies, ce qui signifie que les ensembles de données vectorielles ont généralement un haut niveau de précision (mais pas nécessairement d’exactitude, comme nous le verrons dans la section @ref(unités)).
Le <em>modèle de données raster</em> divise la surface en pixel de taille constante.
Les données rasters sont la base des images d’arrière-plan utilisées dans les cartes Web et constituent une source essentielle de données géographiques depuis les débuts de la photographie aérienne et des dispositifs de télédétection par satellite.
Les rasters agrègent spatialement des informations à une résolution donnée. Ils maintiennent aisni une consistance temporelle sur de grandes superficies (de nombreux jeux de données rasters sont disponibles à l’echelle planetaire).</p>
<p>Que faut-il utiliser ?
La réponse dépend probablement de votre domaine d’application :</p>
<ul>
<li>Les données vectorielles ont tendance à dominer les sciences sociales parce que les constructions humains ont tendance à avoir des frontières discrètes.</li>
<li>Les données rasters dominent de nombreuses sciences de l’environnement en raison de la dépendance aux données de télédétection.</li>
</ul>
<p>Il y a beaucoup de chevauchement dans certains domaines et les ensembles de données rasters et vectorielles peuvent être utilisés conjointement :
les écologistes et les démographes, par exemple, utilisent couramment les deux.
En outre, il est possible de le convertir (voir la section <a href="#raster-vector"><strong>??</strong></a>).
Que votre travail mobilise plus un type de jeux de données, vectorielles ou rasters, il reste utile de comprendre leurs modèles de données sous-jacents pour bien les utiliser, comme nous le verrons dans les chapitres suivants.
Ce livre utilise les paquets <strong>sf</strong> et <strong>terra</strong> pour travailler, respectivement, avec des données vectorielles et des jeux de données raster.</p>
</div>
<div id="données-vectorielles" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Données vectorielles<a class="anchor" aria-label="anchor" href="#donn%C3%A9es-vectorielles"><i class="fas fa-link"></i></a>
</h2>

<div class="rmdnote">
Attention lorsque vous utilisez le mot ‘vecteur’ car il peut avoir deux significations dans ce livre :
les données vectorielles géographiques et la classe <code>vector</code> (notez la police <code>monospace</code>) dans R.
Le premier est un modèle de données, le second est une classe informatique de R tout comme le sont <code>data.frame</code> et <code>matrix</code>.
Il existe néanmoins un lien entre les deux : les coordonnées spatiales qui sont au cœur du modèle de données vectorielles géographiques peuvent être représentées en R à l´aide d´objets <code>vector</code>.
</div>
<p>Le modèle de données géographiques vectorielles est basé sur des points situés dans un système de coordonnées et de référence (SCR).
Les points peuvent représenter des caractéristiques propres (par exemple, l’emplacement d’un arrêt de bus) ou être reliés entre eux pour former des géométries plus complexes telles que des lignes et des polygones.
La plupart des géométries construites avec des points ne sont qu’en deux dimensions (les CRS tridimensionnels contiennent une valeur supplémentaire <span class="math inline">\(z\)</span>, représentant généralement la hauteur au-dessus du niveau de la mer).</p>
<p>Dans ce système, Londres, par exemple, peut être représentée par les coordonnées <code>c(-0,1, 51,5)</code>.
Cela signifie que sa position est -0,1 degré est et 51,5 degrés nord par rapport au point d’origine.
Ce dernier se situe à 0 degré de longitude (le méridien d’origine) et à 0 degré de latitude (l’équateur) dans un SCR géographique (‘long/lat’) (Figure <a href="spatial-class.html#fig:vectorplots">2.1</a>, panneau de gauche).
Cette même localisation pourrait également être approximé dans un SCR projeté avec des valeurs “Est/Nord” de <code>c(530000, 180000)</code> dans le [<em>British National Grid</em>] (<a href="https://en.wikipedia.org/wiki/Ordnance_Survey_National_Grid" class="uri">https://en.wikipedia.org/wiki/Ordnance_Survey_National_Grid</a>), ce qui signifie que Londres est située à 530 km <em>Est</em> et 180 km <em>Nord</em> de l’origine du SCR.
Ceci peut être vérifié visuellement : un peu plus de 5 “boîtes” — des zones carrées délimitées par les lignes de grille grises de 100 km de large — séparent le point représentant Londres de l’origine (Figure <a href="spatial-class.html#fig:vectorplots">2.1</a>, panneau de droite).</p>
<p>L’emplacement de l’origine de la grille Nationale, dans la mer au-delà de la péninsule du sud-ouest de l’Angleterre, garantit que la plupart des lieux du Royaume-Uni auront des valeurs positives en abscisse et ordonnée.<a href="spatial-class.html#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>
Les SCR sont plus complexes, et seront abordées plus en détail dans les sections <a href="spatial-class.html#crs-intro">2.4</a> et <a href="#reproj-geo-data"><strong>??</strong></a>. Cependant pour les besoins de cette section, il suffit de savoir que les coordonnées consistent en deux nombres représentant la distance par rapport à un point d’origine, généralement dans les dimensions <span class="math inline">\(x\)</span> puis <span class="math inline">\(y\)</span>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:vectorplots"></span>
<img src="figures/vector_lonlat.png" alt="Représentation de données vectorielles (ponctuelles) dans laquelle l'emplacement de Londres (X rouge) est représenté par rapport à une origine (le cercle bleu). La carte de gauche représente un SCR géographique dont l'origine se situe à 0° de longitude et de latitude. Le graphique de droite représente un SCR projeté dont l'origine est située dans la mer à l'ouest de la péninsule du sud-ouest anglaise." width="49%"><img src="figures/vector_projected.png" alt="Représentation de données vectorielles (ponctuelles) dans laquelle l'emplacement de Londres (X rouge) est représenté par rapport à une origine (le cercle bleu). La carte de gauche représente un SCR géographique dont l'origine se situe à 0° de longitude et de latitude. Le graphique de droite représente un SCR projeté dont l'origine est située dans la mer à l'ouest de la péninsule du sud-ouest anglaise." width="49%"><p class="caption">
FIGURE 2.1: Représentation de données vectorielles (ponctuelles) dans laquelle l’emplacement de Londres (X rouge) est représenté par rapport à une origine (le cercle bleu). La carte de gauche représente un SCR géographique dont l’origine se situe à 0° de longitude et de latitude. Le graphique de droite représente un SCR projeté dont l’origine est située dans la mer à l’ouest de la péninsule du sud-ouest anglaise.
</p>
</div>
<p><strong>sf</strong> fournis des classes informatiques pour les données géographiques vectorielles ainsi qu’une interface en ligne de commande pour des bibliothèques de géocomputation de bas niveau :</p>
<ul>
<li>GDAL, pour la lecture, l’écriture et la manipulation d’une large gamme de formats de données géographiques, couverte dans le chapitre <a href="#read-write"><strong>??</strong></a>
</li>
<li>PROJ, une puissante bibliothèque pour les transformations de systèmes de coordonnées, qui sous-tend le chapitre <a href="#reproj-geo-data"><strong>??</strong></a>
</li>
<li>GEOS, un moteur de géométrie éuclidienne pour les opérations telles que le calcul des tampons et des centroïdes sur les données avec un SCR projeté, couvert dans le chapitre <a href="#geometric-operations"><strong>??</strong></a>
</li>
<li>
<a href="https://s2geometry.io/">S2</a>, un moteur de géométrie sphérique écrit en C++ développé par Google, via le paquet <a href="https://r-spatial.github.io/s2/"><strong>s2</strong></a>, couvert dans la section <a href="spatial-class.html#s2">2.2.9</a> ci-dessous et dans le chapitre <a href="#reproj-geo-data"><strong>??</strong></a>.
<!-- - [liblwgeom](https://github.com/postgis/postgis/tree/master/liblwgeom), a geometry engine used by PostGIS, via the [**lwgeom**](https://r-spatial.github.io/lwgeom/) package -->
</li>
</ul>
<p>Les informations concernant ces interfaces sont indiquées par <em>sf</em> lorsque que celui ci est chargé pour la première fois: via le message <code>Linking to GEOS 3.8.0, GDAL 3.0.4, PROJ 6.3.1; sf_use_s2() is TRUE</code> apparue en dessous de ;a commande <code><a href="https://r-spatial.github.io/sf/">library(sf)</a></code> au tout début de ce chapitre. Ce message indique les versions des bibliothèques liées GEOS, GDAL et PROJ (chiffre pouvant varier au cours du temps et entre les ordinateurs) et si oui ou non l’interface avec S2 est activée.
Aujourd’hui, nous considérons que c’est un acquis, cependant, c’est grâce à l’intégration étroite entre les différentes bibliothèques géographiques qu’un travail de géocomputation reproductible est possible.</p>
<p>Une fonctionnalité intéressante de <strong>sf</strong> est que vous pouvez changer le moteur de géométrie par défaut utilisé sur les données non projetées : “Désactiver” S2 peut être fait avec la commande <code>sf::sf_use_s2("FALSE")</code>, ce qui signifie que le moteur de géométrie euclidienne GEOS sera utilisé par défaut pour toutes les opérations de géométrie, y compris celles sur les données non projetées.
Comme nous le verrons dans la Section <a href="spatial-class.html#s2">2.2.9</a>, la géométrie euclidienne, ou plane, est basée sur un espace à 2 dimensions.
Les moteurs de géométrie euclidienne tels que GEOS supposent des coordonnées “plates” (projetées), tandis que les moteurs de géométrie sphérique tels que S2 supposent des coordonnées non projetées (lon/lat).</p>
<p>Cette section présente les classes <strong>sf</strong> en préparation des chapitres suivants (les chapitres <a href="#geometric-operations"><strong>??</strong></a> et <a href="#read-write"><strong>??</strong></a> couvrent respectivement l’interface GEOS et GDAL)</p>
<div id="une-introduction-aux-simple-features" class="section level3" number="2.2.1">
<h3>
<span class="header-section-number">2.2.1</span> Une introduction aux <em>Simple Features</em><a class="anchor" aria-label="anchor" href="#une-introduction-aux-simple-features"><i class="fas fa-link"></i></a>
</h3>
<p><em>Simple features</em> est un <a href="http://portal.opengeospatial.org/files/?artifact_id=25355">Format ouvert</a> développé et approuvé par l’Open Geospatial Consortium (OGC), une organisation à but non lucratif dont nous reviendrons sur les activités dans un chapitre ultérieur (section <a href="#file-formats"><strong>??</strong></a>).

<em>Simple Features</em> est un modèle de données hiérarchique qui représente un large éventail de types géométriques.
Sur les 18 types géométriques pris en charge par la spécification, seuls 7 sont utilisés dans la grande majorité des recherches géographiques (voir Figure <a href="spatial-class.html#fig:sf-ogc">2.2</a>) ;
ces types géométriques de base sont entièrement pris en charge par le paquet R <strong>sf</strong> <span class="citation">(<a href="spatial-class.html#ref-pebesma_simple_2018" role="doc-biblioref">Pebesma 2018</a>)</span>.<a href="spatial-class.html#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sf-ogc"></span>
<img src="figures/sf-classes.png" alt="Les types de *Simple features* pleinement disponibles dans sf." width="60%"><p class="caption">
FIGURE 2.2: Les types de <em>Simple features</em> pleinement disponibles dans sf.
</p>
</div>
<p><strong>sf</strong> peut représenter tous les types de géométrie vectorielle courants (les classes de données raster ne sont pas prises en charge par <strong>sf</strong>) : points, lignes, polygones et leurs versions “multi” respectives (qui regroupent les caractéristiques du même type en une seule caractéristique).


<strong>sf</strong> prend également en charge les collections de géométrie, qui peuvent contenir plusieurs types de géométrie dans un seul objet.
<strong>sf</strong> fournit la même fonctionnalité (et plus) que celle fournie précédemment dans trois packages — <strong>sp</strong> pour les classes de données <span class="citation">(<a href="spatial-class.html#ref-R-sp" role="doc-biblioref">Pebesma and Bivand 2018</a>)</span>, <strong>rgdal</strong> pour la lecture/écriture de données via une interface avec GDAL et PROJ <span class="citation">(<a href="spatial-class.html#ref-R-rgdal" role="doc-biblioref">Bivand, Keitt, and Rowlingson 2018</a>)</span> et <strong>rgeos</strong> pour les opérations spatiales via une interface avec GEOS <span class="citation">(<a href="spatial-class.html#ref-R-rgeos" role="doc-biblioref">Bivand and Rundel 2018</a>)</span>.</p>
<p>Pour réitérer le message du chapitre 1, les paquets géographiques de Ront une longue histoire d’interfaçage avec des bibliothèques de plus bas inférieur, et <strong>sf</strong> poursuit cette tradition avec une interface unifiée vers les versions récentes de GEOS pour les opérations de géométrie, la bibliothèque GDAL pour la lecture et l’écriture de fichiers de données géographiques, et la bibliothèque PROJ pour la représentation et la transformation des systèmes de référence de coordonnées projetées.
Grâce à <strong>s2</strong>,
<!-- **s2** functions have replaced **lwgeom** ones (Bivand 2021). -->
<!-- and **lwgeom**, **sf** also has an inter to PostGIS's [`liblwgeom`](https://github.com/postgis/postgis/tree/master/liblwgeom) library  -->
“une interface avec la bibliothèque de géométrie sphérique de Google [<code>s2</code>] (<a href="https://s2geometry.io/" class="uri">https://s2geometry.io/</a>), <strong>sf</strong> a également accès à des”mesures et opérations sur des géométries non planes” rapides et précises” <span class="citation">(<a href="spatial-class.html#ref-bivand_progress_2021" role="doc-biblioref">Bivand 2021</a>)</span>.
Depuis la version 1.0.0 de <strong>sf</strong>, lancée en <a href="https://cran.r-project.org/src/contrib/Archive/sf/">juin 2021</a>, la fonctionnalité <strong>s2</strong> est maintenant utilisée par <a href="https://r-spatial.org/r/2020/06/17/s2.html">défaut</a> sur les géométries avec des systèmes de coordonnées géographiques (longitude/latitude), une caractéristique unique de <strong>sf</strong> qui diffère des bibliothèques spatiales ne prenant en charge que GEOS pour les opérations de géométrie, comme le paquet Python <a href="geopandas/geopandas/issues/2098">GeoPandas</a>.
Nous aborderons <strong>s2</strong> dans les chapitres suivants.
<!-- Todo: link to them, e.g. (RL 2021-11) -->
<!-- See sections \@ref(s2) and \@ref(buffers) for further details. --></p>
<p>La capacité de <strong>sf</strong> à intégrer plusieurs bibliothèques puissantes pour la géoinformatique dans un seul cadre est une réalisation remarquable qui réduit le “coût d’entrée” dans le monde de l’analyse reproductible des données géographiques avec des bibliothèques performantes.
La fonctionnalité de <strong>sf</strong> est bien documentée sur son site web à l’adresse [r-spatial.github.io/sf/] (<a href="https://r-spatial.github.io/sf/index.html" class="uri">https://r-spatial.github.io/sf/index.html</a>) qui contient 7 vignettes.
Celles-ci peuvent être visualisées hors ligne comme suit :</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html">vignette</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span> <span class="co"># Qu'elles sont les vignettes disponibles</span>
<span class="fu"><a href="https://rdrr.io/r/utils/vignette.html">vignette</a></span><span class="op">(</span><span class="st">"sf1"</span><span class="op">)</span>          <span class="co"># Une introduction à la bibliothèque </span></code></pre></div>
<p>Comme l’explique la première vignette, les objets de type <em>simples features</em> dans R sont stockés dans un tableau de données, les données géographiques occupant une colonne spéciale, généralement nommée “geom” ou “geometry”.
Nous allons utiliser le jeu de données <code>world</code> fourni par la bibliothèque <strong>spData</strong>, chargé au début de ce chapitre, pour montrer ce que sont les objets <code>sf</code> et comment ils fonctionnent.
<code>world</code> est un “tableau de données <code>sf</code>” contenant des colonnes spatiales et attributaires, dont les noms sont retournés par la fonction <code><a href="https://rdrr.io/pkg/terra/man/names.html">names()</a></code> (la dernière colonne dans cet exemple contient les informations géographiques) :</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">world</span><span class="op">)</span>
<span class="co">#&gt; [1] "sf"         "tbl_df"     "tbl"        "data.frame"</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/names.html">names</a></span><span class="op">(</span><span class="va">world</span><span class="op">)</span>
<span class="co">#&gt;  [1] "iso_a2"    "name_long" "continent" "region_un" "subregion" "type"     </span>
<span class="co">#&gt;  [7] "area_km2"  "pop"       "lifeExp"   "gdpPercap" "geom"</span></code></pre></div>
<p>Le contenu de cette colonne <code>geom</code> donne aux objets <code>sf</code> leurs proprités spatialles : <code>world$geom</code> est une ‘<a href="https://adv-r.hadley.nz/vectors-chap.html#list-columns">colonne de type liste</a>’ qui contient toutes les coordonnées des polygones du pays.

Les objets <code>sf</code> peuvent être tracés rapidement avec la fonction de base de R, <code><a href="https://rdrr.io/pkg/terra/man/plot.html">plot()</a></code> ;
la commande suivante crée la figure <a href="spatial-class.html#fig:world-all">2.3</a>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">world</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:world-all"></span>
<img src="02-spatial-data_files/figure-html/world-all-1.png" alt="Cartes du monde utilisant le paquet sf, avec une dimension pour chaque attribut." width="100%"><p class="caption">
FIGURE 2.3: Cartes du monde utilisant le paquet sf, avec une dimension pour chaque attribut.
</p>
</div>
<p>Notez qu’au lieu de créer une seule carte par défaut pour les objets géographiques, comme le font la plupart des programmes SIG, la fonction <code><a href="https://rdrr.io/pkg/terra/man/plot.html">plot()</a></code> sur des objets <code>sf</code> retourne une carte pour chaque variable du jeux de données.
Ce comportement peut être utile pour explorer la distribution spatiale de différentes variables et est abordé plus en détail dans la section <a href="spatial-class.html#basic-map">2.2.3</a>.</p>
<p>Plus largement, traiter les objets géographiques comme des tableaux de données classiques avec des propriétés spatiales présente de nombreux avantages, surtout si vous avez déjà l’habitude de travailler avec des tableaux de données.
Par exemple, la fonction très pratique <code><a href="https://rdrr.io/pkg/terra/man/summary.html">summary()</a></code>, fournit un aperçu utile des variables de l’objet <code>world</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html">summary</a></span><span class="op">(</span><span class="va">world</span><span class="op">[</span><span class="st">"lifeExp"</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;     lifeExp                geom    </span>
<span class="co">#&gt;  Min.   :50.6   MULTIPOLYGON :177  </span>
<span class="co">#&gt;  1st Qu.:65.0   epsg:4326    :  0  </span>
<span class="co">#&gt;  Median :72.9   +proj=long...:  0  </span>
<span class="co">#&gt;  Mean   :70.9                      </span>
<span class="co">#&gt;  3rd Qu.:76.8                      </span>
<span class="co">#&gt;  Max.   :83.6                      </span>
<span class="co">#&gt;  NA's   :10</span></code></pre></div>
<p>Bien que nous n’ayons sélectionné qu’une seule variable pour la commande <code><a href="https://rdrr.io/pkg/terra/man/summary.html">summary()</a></code>, elle produit également un rapport sur la géométrie.
Cela démontre le comportement “permanent” des colonnes de type géométrie des objets <strong>sf</strong>, cela signifie que la géométrie est conservée à moins que l’utilisateur ne la supprime délibérément, comme nous le verrons dans la Section <a href="#vector-attribute-manipulation"><strong>??</strong></a>.
Le résultat fournit un résumé rapide des données spatiales et non spatiales contenues dans <code>world</code> : l’espérance de vie moyenne est de 71 ans (allant de moins de 51 ans à plus de 83 ans avec une médiane de 73 ans) pour tous les pays.</p>

<div class="rmdnote">
Le mot <code>MULTIPOLYGON</code> dans le résumé ci-dessus fait référence au type de géométrie des éléments (pays) dans l´objet <code>world</code>.
Cette représentation est nécessaire pour les pays comportant des îles comme l´Indonésie et la Grèce.
Les autres types de géométrie sont décrits dans la section <a href="spatial-class.html#geometry">2.2.4</a>.
</div>
<p>Il est important d’examiner de plus près le comportement de base et le contenu de cet objet <em>simple feature</em>, que l’on peut utilement considérer comme un “<strong>s</strong>patial data <strong>f</strong>rames”.</p>
<p>Les objets <code>sf</code> sont faciles à extraire: le code ci-dessous extrait ses deux premières lignes et trois premières colonnes de <code>world</code>.
La sortie montre deux différences majeures par rapport à un <code>data.frame</code> standard : l’inclusion de données géographiques supplémentaires (<code>geometry type</code>, <code>dimension</code>, <code>bbox</code> et les informatio<code>ns SCR -</code>epsg (SRID)<code>,</code>proj4string<code>) ainsi que la présence d'une colonne</code>geometry<code>, ici nommée</code>geom` :</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">world_mini</span> <span class="op">=</span> <span class="va">world</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>
<span class="va">world_mini</span>
<span class="co">#&gt; Simple feature collection with 2 features and 3 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -180 ymin: -18.3 xmax: 180 ymax: -0.95</span>
<span class="co">#&gt; Geodetic CRS:  WGS 84</span>
<span class="co">#&gt; # A tibble: 2 × 4</span>
<span class="co">#&gt;   iso_a2 name_long continent                                                geom</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;                                      &lt;MULTIPOLYGON [°]&gt;</span>
<span class="co">#&gt; 1 FJ     Fiji      Oceania   (((-180 -16.6, -180 -16.5, -180 -16, -180 -16.1, -…</span>
<span class="co">#&gt; 2 TZ     Tanzania  Africa    (((33.9 -0.95, 31.9 -1.03, 30.8 -1.01, 30.4 -1.13,…</span></code></pre></div>
<p>Tout cela peut sembler assez complexe, surtout pour un système de classes qui est censé être simple.
Cependant, il y a de bonnes raisons d’organiser les choses de cette façon et d’utiliser <strong>sf</strong>.</p>
<p>Avant de décrire chaque type de géométrie géré par le paquet <strong>sf</strong>, il est utile de prendre un peu de recul pour comprendre les éléments constitutifs des objets de type <code>sf</code>.
La section <a href="spatial-class.html#sf">2.2.5</a> montre comment les objets <em>simples features</em> sont des tableau de données, avec des colonnes géométriques spéciales.
Ces colonnes spatiales sont souvent appelées <code>geom</code> ou <code>geometry</code> : ainsi <code>world$geom</code> fait référence à l’élément spatial de l’objet <code>world</code> décrit plus haut.
Ces colonnes géométriques sont des “colonnes de type liste” de la classe <code>sfc</code> (voir la section <a href="spatial-class.html#sfc">2.2.7</a>).
Puis, à leur tour, les objets <code>sfc</code> sont composés d’un ou plusieurs objets de la classe <code>sfg</code> : des géométries <em>simples features</em> que nous décriverons dans la section <a href="spatial-class.html#sfg">2.2.6</a>.

</p>
<p>Pour comprendre comment fonctionnent les composantes spatiales des <em>simples features</em>, il est essentiel de comprendre comment leurs géométries sont prises en comptes.
C’est pourquoi nous couvrirons chacun des types de géométrie <em>simples features</em> actuellement pris en charge dans la section <a href="spatial-class.html#geometry">2.2.4</a> puis nous continuerons en montrant comment ils peuvent être représentés dans R en utilisant avec des objets <code>sf</code>, formés à la base d’objets <code>sfg</code> et <code>sfc</code>.</p>
<pre class="bloc2"><code>Le morceau de code précédent utilise `=` pour créer un nouvel objet appelé `world_mini` dans la commande `world_mini = world[1:2, 1:3]`.
C´est ce qu´on appelle une affectation.
Une commande équivalente pour obtenir le même résultat est `world_mini &lt;- world[1:2, 1:3]`.
Bien que l´affectation par flèche soit plus couramment utilisée, nous utilisons l´affectation par égalité parce qu´elle est légèrement plus rapide à taper et plus facile à enseigner en raison de sa compatibilité avec les langages couramment utilisés tels que Python et JavaScript.
L´utilisation de l´un ou l´autre est une question de préférence, tant que vous êtes cohérent (des paquets tels que **styler** peuvent être utilisés pour changer de style).</code></pre>
</div>
<div id="pourquoi-simple-features" class="section level3" number="2.2.2">
<h3>
<span class="header-section-number">2.2.2</span> Pourquoi <em>simple features</em>?<a class="anchor" aria-label="anchor" href="#pourquoi-simple-features"><i class="fas fa-link"></i></a>
</h3>
<p>Les <em>simple features</em> sont un modèle de données largement utilisé qui sous-tend les structures de données de nombreuses applications SIG, notamment QGIS et PostGIS.
L’un des principaux avantages de cette approche est que l’utilisation du modèle de données garantit que votre travail est transférable à d’autres configurations, par exemple l’importation et l’exportation vers des bases de données spatiales.
</p>
<p>Une question plus spécifique du point de vue de R est “pourquoi utiliser le paquet <strong>sf</strong> alors que <strong>sp</strong> est déjà éprouvé” ?
Il existe de nombreuses raisons (liées notamment aux avantages du modèle des <em>simple features</em>) :</p>
<ul>
<li>Lecture et écriture rapides des données<br>
</li>
<li>Amélioration des performances de représentation graphique<br>
</li>
<li>Les objets <strong>sf</strong> peuvent être traités comme des tableau de données dans la plupart des opérations.<br>
</li>
<li>Les noms des fonctions <strong>sf</strong> sont relativement cohérents et intuitifs (tous commencent par <code>st_</code>)<br>
</li>
<li>Les fonctions <strong>sf</strong> peuvent être combinées à l’aide de l’opérateur <code>%&gt;%</code> et fonctionnent bien avec la collection <a href="http://tidyverse.org/">tidyverse</a> des paquets R.</li>
</ul>
<p>L’intégration de <strong>sf</strong> pour les paquets <strong>tidyverse</strong> est illustré avec la fonction de lecture des données géographiques vectorisées: <code><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf()</a></code>.
Au contraire de la fonction <code><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read()</a></code> qui va retourner les attributs dans les classes de base R <code>data.frame</code> (et affiche un message de compte rendu plus complet qui dans l’extrait de code ci dessous a été omis) la fonction <code><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf()</a></code> va retourner un <strong>tidyverse</strong> <code>tibble</code>.
Vous en trouvez la démonstration ci-dessous (voir la section <a href="#iovec"><strong>??</strong></a> sur la lecture et l’écriture des données géographiques vectorielles avec R) :</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nc_dfr</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"shape/nc.shp"</span>, package <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Reading layer `nc' from data source </span>
<span class="co">#&gt;   `/usr/local/lib/R/site-library/sf/shape/nc.shp' using driver `ESRI Shapefile'</span>
<span class="co">#&gt; Simple feature collection with 100 features and 14 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -84.3 ymin: 33.9 xmax: -75.5 ymax: 36.6</span>
<span class="co">#&gt; Geodetic CRS:  NAD27</span>
<span class="va">nc_tbl</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"shape/nc.shp"</span>, package <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">nc_dfr</span><span class="op">)</span>
<span class="co">#&gt; [1] "sf"         "data.frame"</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">nc_tbl</span><span class="op">)</span>
<span class="co">#&gt; [1] "sf"         "tbl_df"     "tbl"        "data.frame"</span></code></pre></div>
<p>Comme illusté dans le Chapitre <a href="#attr"><strong>??</strong></a>, montrant la manipulation d’objet `sf avec le <strong>tidyverse</strong>, <strong>sf</strong> est désormais la bibliothèquee de référence pour l’analyse des données vectorielles spatiales dans R (sans oublier l’écosystème des pacquets <strong>spatstat</strong> qui fournit de nombreuses fonctions pour les statistiques spatiales).
De nombreux paquets populaires reposent sur <strong>sf</strong>, comme le montre l’augmentation de sa popularité en termes de nombre de téléchargements par jour, comme indiqué dans la section <a href="intro.html#r-ecosystem">1.4</a> du chapitre précédent.
La transition de paquets et de chaîne de processus reposant sur les anciens paquets <strong>rgeos</strong> et <strong>rgdal</strong> prends du temps <span class="citation">(<a href="spatial-class.html#ref-bivand_progress_2021" role="doc-biblioref">Bivand 2021</a>)</span>, mais le processus a été acceleré par le sentiments d’urgence par les messages indiquant qu’ils “seraient indisponible à partir de fin 2023”.
Cela signifie que quiconque utilisant encore ces paquets se doit de “<strong>passer aux fonctions de sf/stars/terra pour utiliser GDAL et PROJ le plus rapidement possible.</strong>”.</p>
<p>En d’autres termes, <strong>sf</strong> est à l’épreuve du futur mais <strong>sp</strong> ne l’est pas.
Pour les <em>workflow</em> qui dépendent de l’ancienne classe <code>Spatial</code>, les objets <code>sf</code> peuvent être convertis depuis et vers la classe <code>Spatial</code> du paquet <strong>sp</strong> comme suit :</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span>
<span class="va">world_sp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html">as</a></span><span class="op">(</span><span class="va">world</span>, <span class="st">"Spatial"</span><span class="op">)</span> <span class="co"># de sf à sp</span>
<span class="co"># sp functions ...</span>
<span class="va">world_sf</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">world_sp</span><span class="op">)</span>           <span class="co"># de sp à sf</span></code></pre></div>
</div>
<div id="basic-map" class="section level3" number="2.2.3">
<h3>
<span class="header-section-number">2.2.3</span> Réalisation rapide de cartes<a class="anchor" aria-label="anchor" href="#basic-map"><i class="fas fa-link"></i></a>
</h3>
<p>Des premiers jets de cartes peuvent être crées dans <strong>sf</strong> avec <code><a href="https://rdrr.io/pkg/terra/man/plot.html">plot()</a></code>.
Par défaut, cela crée un graphique avec de multiple encarts (comme <code><a href="https://rdrr.io/pkg/sp/man/spplot.html">spplot()</a></code> de <strong>sp</strong>), un encart pour chaque variable de l’objet, comme illustré dans le panneau de gauche de la Figure <a href="spatial-class.html#fig:sfplot">2.4</a>.
Une légende ou “clé” avec une couleur continue est produite si l’objet à tracer a une seule variable (voir l’encart de droite).
Les couleurs peuvent également être définies avec l’argument <code>col =</code>, bien que cela ne permette pas de créer une palette continue ou une légende.
</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">world</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">world</span><span class="op">[</span><span class="st">"pop"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sfplot"></span>
<img src="02-spatial-data_files/figure-html/sfplot-1.png" alt="Cartographie avec sf, avec plusieurs variables (gauche) ou une seule (droite)." width="49%"><img src="02-spatial-data_files/figure-html/sfplot-2.png" alt="Cartographie avec sf, avec plusieurs variables (gauche) ou une seule (droite)." width="49%"><p class="caption">
FIGURE 2.4: Cartographie avec sf, avec plusieurs variables (gauche) ou une seule (droite).
</p>
</div>
<p>Les graphiques sont ajoutés en tant que couches aux images existantes en ajoutant dans la fonction l’argument <code>add = TRUE</code>.<a href="spatial-class.html#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a>
Pour illustrer cela et donner un avant-goût du contenu des chapitres <a href="#attr"><strong>??</strong></a> et <a href="#spatial-operations"><strong>??</strong></a> sur les attributs et les opérations sur les données spatiales, l’extrait de code suivant combine des pays d’Asie :</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">world_asia</span> <span class="op">=</span> <span class="va">world</span><span class="op">[</span><span class="va">world</span><span class="op">$</span><span class="va">continent</span> <span class="op">==</span> <span class="st">"Asia"</span>, <span class="op">]</span>
<span class="va">asia</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">world_asia</span><span class="op">)</span></code></pre></div>
<p>Ainsi pouvons maintenant dessiner le continent asiatique sur une carte du monde.
Notez que le premier graphe ne doit avoir qu’un seul encart pour que <code>add = TRUE</code> fonctionne.
Si le premier graphe a une légende, <code>reset = FALSE</code> doit être utilisé (résultat non montré) :</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">world</span><span class="op">[</span><span class="st">"pop"</span><span class="op">]</span>, reset <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">asia</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p>L’ajout de couches de cette manière peut être utilisé pour vérifier la correspondance géographique entre les couches :
la fonction <code><a href="https://rdrr.io/pkg/terra/man/plot.html">plot()</a></code> est rapide à exécuter et nécessite peu de lignes de code, mais ne permet pas de créer des cartes interactives avec une large gamme d’options.
Pour la réalisation de cartes plus poussées, nous recommandons l’utilisation de paquets de visualisation spécifiques tels que <strong>tmap</strong> (voir le chapitre <a href="#adv-map"><strong>??</strong></a>).</p>
<p>Il y a plusieurs façons de modifier les cartes avec la méthode <code><a href="https://rdrr.io/pkg/terra/man/plot.html">plot()</a></code> de <strong>sf</strong>.
Comme <strong>sf</strong> étend les méthodes de base de R, les arguments de <code><a href="https://rdrr.io/pkg/terra/man/plot.html">plot()</a></code> tels que <code>main =</code> (qui spécifie le titre de la carte) fonctionnent avec les objets <code>sf</code> (voir <code><a href="https://rdrr.io/r/graphics/plot.default.html">?graphics::plot</a></code> et <code><a href="https://rdrr.io/r/graphics/par.html">?par</a></code>).<a href="spatial-class.html#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a>

</p>
<p>La figure <a href="spatial-class.html#fig:contpop">2.5</a> illustre cette flexibilité en superposant sur une carte du monde des cercles dont les diamètres (définis avec l’argument <code>cex =</code>) représentent les populations des pays.
Une version non projetée de cette figure peut être créée avec les commandes suivantes (voir les exercices à la fin de ce chapitre et le script <a href="https://github.com/Robinlovelace/geocompr/blob/main/code/02-contpop.R"><code>02-contplot.R</code></a> <a href="spatial-class.html#fig:contpop">2.5</a>):</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">world</span><span class="op">[</span><span class="st">"continent"</span><span class="op">]</span>, reset <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">cex</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/math-generics.html">sqrt</a></span><span class="op">(</span><span class="va">world</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10000</span>
<span class="va">world_cents</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_centroid</a></span><span class="op">(</span><span class="va">world</span>, of_largest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">world_cents</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, cex <span class="op">=</span> <span class="va">cex</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:contpop"></span>
<img src="02-spatial-data_files/figure-html/contpop-1.png" alt="Pays coloriés par continents et leurs populations en  2015 populations (cercles proportionnels à la population)." width="100%"><p class="caption">
FIGURE 2.5: Pays coloriés par continents et leurs populations en 2015 populations (cercles proportionnels à la population).
</p>
</div>
<p>Le code ci-dessus utilise la fonction <code><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_centroid()</a></code> pour convertir un type de géométrie (polygones) en un autre (points) (voir chapitre <a href="#geometric-operations"><strong>??</strong></a>), dont la représentation varie en fonction de l’argument <code>cex</code>.</p>
<p>
La méthode plot de <strong>sf</strong> possède également des arguments spécifiques aux données géographiques. <code>expandBB</code>, par exemple, peut être utilisé pour dessiner un objet <code>sf</code> dans son contexte :
elle prend un vecteur de quatre nombres qui étend la boîte de délimitation de la carte par rapport à zéro en lsuivant l’ordre : bas, gauche, haut, droite.
C’est ce que nous avons utilisé dans le morceau de code suivant pour représenter l’Inde dans le contexte de ses gigantesques voisins asiatiques, en mettant l’accent sur la Chine à l’est <a href="spatial-class.html#fig:china">2.6</a> (voir les ci-dessous sur l’ajout de texte aux graphiques) :</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">india</span> <span class="op">=</span> <span class="va">world</span><span class="op">[</span><span class="va">world</span><span class="op">$</span><span class="va">name_long</span> <span class="op">==</span> <span class="st">"India"</span>, <span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">india</span><span class="op">)</span>, expandBB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"gray"</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">world_asia</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:china"></span>
<img src="02-spatial-data_files/figure-html/china-1.png" alt="L'Inde en contexte, demonstration de l'argument the expandBB." width="50%"><p class="caption">
FIGURE 2.6: L’Inde en contexte, demonstration de l’argument the expandBB.
</p>
</div>
<p>Notez l’utilisation de <code>[0]</code> pour ne garder que la colonne de géométrie et de <code>lwd</code> pour mettre l’accent sur l’Inde.
La prochaine section <a href="#other-mapping-packages"><strong>??</strong></a> présente d’autres techniques de visualisation permettant de représenter une gamme de types de géométrie.</p>
</div>
<div id="geometry" class="section level3" number="2.2.4">
<h3>
<span class="header-section-number">2.2.4</span> Les types de geométries<a class="anchor" aria-label="anchor" href="#geometry"><i class="fas fa-link"></i></a>
</h3>
<p>Les géométries sont les éléments de base de <em>simples features</em>.
Ils peuvent prendre dans R l’un des 18 types de géométrie pris en charge par le paquet <strong>sf</strong>.


Dans ce chapitre, nous nous concentrerons sur les sept types les plus couramment utilisés : <code>POINT</code>, <code>LINESTRING</code>, <code>POLYGON</code>, <code>MULTIPOINT</code>, <code>MULTILINESTRING</code>, <code>MULTIPOLYGON</code> et <code>GEOMETRYCOLLECTION</code>.
La liste complète des types d’éléments possibles est disponible dans <a href="http://postgis.net/docs/using_postgis_dbmanagement.html">le manuel de PostGIS</a>.</p>
<p>En général, le <em>well-known binary</em> (WKB) ou le <em>well-known text</em> (WKT) sont les codages standard pour les géométries simples.



Les WKB sont généralement représentés par des chaînes hexadécimales facilement lisibles par les ordinateurs.
C’est pourquoi les SIG et les bases de données spatiales l’utilisent pour transférer et stocker des objets géométriques.
Le WKT, quant à lui, est une description de balisage textuel lisible par l’homme pour des <em>simples features</em>.
Les deux formats sont échangeables, et si nous en présentons un, nous choisirons naturellement la représentation WKT.</p>
<p>La base de chaque type de géométrie est le point.
Un point est simplement une coordonnée dans un espace 2D, 3D ou 4D (cf. <code><a href="https://r-spatial.github.io/sf/articles/sf1.html">vignette("sf1")</a></code> pour plus d’information). Un exemple est disponible sur le second panneau de la figure <a href="spatial-class.html#fig:sfcs">2.7</a>:
</p>
<ul>
<li><code>POINT (5 2)</code></li>
</ul>
<p>
Une <em>linestring</em>, ligne, est une séquence de points avec une ligne droite reliant ces points, par exemple (cf. le panneau central de la figure <a href="spatial-class.html#fig:sfcs">2.7</a>) :</p>
<ul>
<li><code>LINESTRING (1 5, 4 4, 4 1, 2 2, 3 2)</code></li>
</ul>
<p>Un polygone est une séquence de points qui forment un anneau fermé, sans intersection.
Fermé signifie que le premier et le dernier point d’un polygone ont les mêmes coordonnées (cf. le panneau de droite de la figure <a href="spatial-class.html#fig:sfcs">2.7</a>).<a href="spatial-class.html#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a>
</p>
<ul>
<li>Polygone sans anneau intérieur: <code>POLYGON ((1 5, 2 2, 4 1, 4 4, 1 5))</code>
</li>
</ul>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sfcs"></span>
<img src="02-spatial-data_files/figure-html/sfcs-1.png" alt="Exemple de géometries de point, ligne et polygone." width="100%"><p class="caption">
FIGURE 2.7: Exemple de géometries de point, ligne et polygone.
</p>
</div>
<p>Jusqu’à présent, nous avons créé des géométries avec une seule entité géométrique par élément.
Toutefois, <strong>sf</strong> permet également l’existence de plusieurs géométries au sein d’une même entité (d’où le terme “collection de géométries”) en utilisant la version “multi” de chaque type de géométrie :
</p>
<ul>
<li>Multipoint: <code>MULTIPOINT (5 2, 1 3, 3 4, 3 2)</code>
</li>
<li>Multilinestring: <code>MULTILINESTRING ((1 5, 4 4, 4 1, 2 2, 3 2), (1 2, 2 4))</code>
</li>
<li>Multipolygon: <code>MULTIPOLYGON (((1 5, 2 2, 4 1, 4 4, 1 5), (0 2, 1 2, 1 3, 0 3, 0 2)))</code>
</li>
</ul>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:multis"></span>
<img src="02-spatial-data_files/figure-html/multis-1.png" alt="Examples de multi* geometries." width="100%"><p class="caption">
FIGURE 2.8: Examples de multi* geometries.
</p>
</div>
<p>Enfin, une collection de géométries peut contenir n’importe quelle combinaison de géométries, y compris des (multi)points et des lignes (voir figure <a href="spatial-class.html#fig:geomcollection">2.9</a>) :
</p>
<ul>
<li>Geometry collection: <code>GEOMETRYCOLLECTION (MULTIPOINT (5 2, 1 3, 3 4, 3 2), LINESTRING (1 5, 4 4, 4 1, 2 2, 3 2))</code>
</li>
</ul>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:geomcollection"></span>
<img src="02-spatial-data_files/figure-html/geomcollection-1.png" alt="Exemple de collection de géometrie." width="33%"><p class="caption">
FIGURE 2.9: Exemple de collection de géometrie.
</p>
</div>
</div>
<div id="sf" class="section level3" number="2.2.5">
<h3>
<span class="header-section-number">2.2.5</span> The sf class<a class="anchor" aria-label="anchor" href="#sf"><i class="fas fa-link"></i></a>
</h3>
<p>Les <em>Simple features</em> sont composés de deux parties principales : les géométries et les attributs non géographiques.
La figure <a href="spatial-class.html#fig:02-sfdiagram">2.10</a> montre comment un objet sf est créé – les géométries proviennent d’un objet <code>sfc</code>, tandis que les attributs sont pris dans un <code>data.frame</code> ou un <code>tibble</code>.
Les sections <a href="spatial-class.html#sfg">2.2.6</a> et <a href="spatial-class.html#sfc">2.2.7</a> reprennent la création de géometries sf à partir de rien.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:02-sfdiagram"></span>
<img src="figures/02-sfdiagram.png" alt="Building blocks of sf objects." width="100%"><p class="caption">
FIGURE 2.10: Building blocks of sf objects.
</p>
</div>
<p>Les attributs non géographiques permettent la représentation du nom de l’entité ou d’autres attributs, mesures, appartenance à des groupes et autres.

Pour l’illustrer nous allons représenter une température de 25°C à Londres le 21 juin 2017.
Cet exemple à une géométrie (les coordonnées) et trois attributs de trois classes différentes (le nom, la température et la data).<a href="spatial-class.html#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a>
Les objets de la classe <code>sf</code> représentent de telles données en combinant les attributs (<code>data.frame</code>) avec la colonne de géométrie <em>simple feature</em> (<code>sfc</code>).
Ils sont créés avec <code><a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf()</a></code>, comme l’illustre le code ci-dessous, créant l’exemple londonien :</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lnd_point</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">51.5</span><span class="op">)</span><span class="op">)</span>                 <span class="co"># objet sfg</span>
<span class="va">lnd_geom</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc</a></span><span class="op">(</span><span class="va">lnd_point</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span>           <span class="co"># objet sfc</span>
<span class="va">lnd_attrib</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>                           <span class="co"># objet data.frame</span>
  name <span class="op">=</span> <span class="st">"London"</span>,
  temperature <span class="op">=</span> <span class="fl">25</span>,
  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2017-06-21"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="va">lnd_sf</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf</a></span><span class="op">(</span><span class="va">lnd_attrib</span>, geometry <span class="op">=</span> <span class="va">lnd_geom</span><span class="op">)</span>    <span class="co"># objet sf</span></code></pre></div>
<p>Que s’est-il passé ? Premièrement, les coordonnés ont été utilisé pour créer la <em>simple feature geometry</em> (<code>sfg</code>).
Deuxièmement, la géométrie a été convertie en une colonne de type <em>simple feature</em> (<code>sfc</code>), avec un SCR.
Troisièmement, les attributs ont été stockés dans un <code>data.frame</code>, qui a été combiné avec l’objet <code>sfc</code> avec <code><a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf()</a></code>.
Le résultat est un objet <code>sf</code>, comme démontré ci-dessous (une partie de la sortie de code est omise) :</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lnd_sf</span>
<span class="co">#&gt; Simple feature collection with 1 features and 3 fields</span>
<span class="co">#&gt; ...</span>
<span class="co">#&gt;     name temperature       date         geometry</span>
<span class="co">#&gt; 1 London          25 2017-06-21 POINT (0.1 51.5)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">lnd_sf</span><span class="op">)</span>
<span class="co">#&gt; [1] "sf"         "data.frame"</span></code></pre></div>
<p>Le résultat montre que les objets <code>sf</code> ont en fait deux classes informatiques, <code>sf</code> et <code>data.frame</code>.
Les <em>Simple features</em> sont simplement des tableau de données mais avec un attribut spatial stocké dans une colonne de type liste, souvent nommée <code>geometry</code>, comme décrit dans la section <a href="#intro-sf"><strong>??</strong></a>.
Cette dualité est au coeur du concept de <em>Simple features</em>:
la plupart du temps un objet <code>sf</code> peut être traité comme un <code>data.frame</code> et se comporté comme tel.
Les <em>Simple features</em> sont, par essence, des tableaux de données avec une extension spatiale.</p>
</div>
<div id="sfg" class="section level3" number="2.2.6">
<h3>
<span class="header-section-number">2.2.6</span> Simple feature geometries (sfg)<a class="anchor" aria-label="anchor" href="#sfg"><i class="fas fa-link"></i></a>
</h3>
<p>La classe <code>sfg</code> représente les différents types de géométrie <em>simple feature</em> dans R : point, ligne, polygone (et leurs équivalents “multi”, comme les multipoints) ou collection de géométries.
</p>
<p>En général, la tâche fastidieuse de création de géométries vous est épargnée car vous pouvez simplement importer un fichier spatial déjà existant.
Cependant, il existe un ensemble de fonctions permettant de créer des objets géométriques <em>simple feature</em> (<code>sfg</code>) à partir de zéro si nécessaire.
Les noms de ces fonctions sont simples et cohérents, ils commencent tous par le préfixe <code>st_</code> et se terminent par le nom du type de géométrie en lettres minuscules :</p>
<ul>
<li>Un point : <code><a href="https://r-spatial.github.io/sf/reference/st.html">st_point()</a></code>
</li>
<li>Une ligne : <code><a href="https://r-spatial.github.io/sf/reference/st.html">st_linestring()</a></code>
</li>
<li>Un polygone: <code><a href="https://r-spatial.github.io/sf/reference/st.html">st_polygon()</a></code>
</li>
<li>Un multipoint: <code><a href="https://r-spatial.github.io/sf/reference/st.html">st_multipoint()</a></code>
</li>
<li>Une multiligne : <code><a href="https://r-spatial.github.io/sf/reference/st.html">st_multilinestring()</a></code>
</li>
<li>Un multipolygone : <code><a href="https://r-spatial.github.io/sf/reference/st.html">st_multipolygon()</a></code>
</li>
<li>Une collection de géométries : <code><a href="https://r-spatial.github.io/sf/reference/st.html">st_geometrycollection()</a></code>
</li>
</ul>
<p>Les objets <code>sfg</code> peuvent être créer à partir de trois de types de données de R:</p>
<ol style="list-style-type: decimal">
<li>Un vecteur numérique: un point unique<br>
</li>
<li>Un matrice: un ensemble de points, où chaque ligne représente un point, un multipoint ou une ligne</li>
<li>Une liste: une collection d’objets comme des matrices, des multilignes ou des collections de géométries.</li>
</ol>
<p>La fonction <code><a href="https://r-spatial.github.io/sf/reference/st.html">st_point()</a></code> créée un point à partir de vecteurs numériques :</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>                 <span class="co"># point en XY</span>
<span class="co">#&gt; POINT (5 2)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>              <span class="co"># point en XYZ</span>
<span class="co">#&gt; POINT Z (5 2 3)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, dim <span class="op">=</span> <span class="st">"XYM"</span><span class="op">)</span> <span class="co"># point en XYM</span>
<span class="co">#&gt; POINT M (5 2 1)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>           <span class="co"># point en XYZM</span>
<span class="co">#&gt; POINT ZM (5 2 3 1)</span></code></pre></div>
<p>Les sorties montrent que les types de points XY (coordonnées 2D), XYZ (coordonnées 3D) et XYZM (3D avec une variable supplémentaire, généralement la précision de mesure) sont créés à partir de vecteurs de longueur 2, 3 et 4, respectivement.
Le type XYM doit être spécifié en utilisant l’argument <code>dim</code> (qui est l’abréviation de dimension).</p>
<p>En revanche, vous devez utiliser des matrices dans le cas des objets multipoints (<code><a href="https://r-spatial.github.io/sf/reference/st.html">st_multipoint()</a></code>) et ligne (<code><a href="https://r-spatial.github.io/sf/reference/st.html">st_linestring()</a></code>) :</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># la fonction rbind simplifie la création de matrices</span>
<span class="co">## MULTIPOINT</span>
<span class="va">multipoint_matrix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_multipoint</a></span><span class="op">(</span><span class="va">multipoint_matrix</span><span class="op">)</span>
<span class="co">#&gt; MULTIPOINT ((5 2), (1 3), (3 4), (3 2))</span>
<span class="co">## LIGNE</span>
<span class="va">linestring_matrix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_linestring</a></span><span class="op">(</span><span class="va">linestring_matrix</span><span class="op">)</span>
<span class="co">#&gt; LINESTRING (1 5, 4 4, 4 1, 2 2, 3 2)</span></code></pre></div>
<p>Enfin, vous devez utiliser les listes pour la création de multilignes, de (multi-)polygones et de collections de géométries :</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## POLYGONE</span>
<span class="va">polygon_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_polygon</a></span><span class="op">(</span><span class="va">polygon_list</span><span class="op">)</span>
<span class="co">#&gt; POLYGON ((1 5, 2 2, 4 1, 4 4, 1 5))</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## POLYGONE avec un trou</span>
<span class="va">polygon_border</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="va">polygon_hole</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="va">polygon_with_hole_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">polygon_border</span>, <span class="va">polygon_hole</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_polygon</a></span><span class="op">(</span><span class="va">polygon_with_hole_list</span><span class="op">)</span>
<span class="co">#&gt; POLYGON ((1 5, 2 2, 4 1, 4 4, 1 5), (2 4, 3 4, 3 3, 2 3, 2 4))</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## MULTILIGNE</span>
<span class="va">multilinestring_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, 
                            <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_multilinestring</a></span><span class="op">(</span><span class="op">(</span><span class="va">multilinestring_list</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; MULTILINESTRING ((1 5, 4 4, 4 1, 2 2, 3 2), (1 2, 2 4))</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## MULTIPOLYGONE</span>
<span class="va">multipolygon_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                         <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_multipolygon</a></span><span class="op">(</span><span class="va">multipolygon_list</span><span class="op">)</span>
<span class="co">#&gt; MULTIPOLYGON (((1 5, 2 2, 4 1, 4 4, 1 5)), ((0 2, 1 2, 1 3, 0 3, 0 2)))</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## COLLECTIONS DE GEOMETRIES</span>
<span class="va">gemetrycollection_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_multipoint</a></span><span class="op">(</span><span class="va">multipoint_matrix</span><span class="op">)</span>,
                              <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_linestring</a></span><span class="op">(</span><span class="va">linestring_matrix</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_geometrycollection</a></span><span class="op">(</span><span class="va">gemetrycollection_list</span><span class="op">)</span>
<span class="co">#&gt; GEOMETRYCOLLECTION (MULTIPOINT (5 2, 1 3, 3 4, 3 2),</span>
<span class="co">#&gt;   LINESTRING (1 5, 4 4, 4 1, 2 2, 3 2))</span></code></pre></div>
</div>
<div id="sfc" class="section level3" number="2.2.7">
<h3>
<span class="header-section-number">2.2.7</span> Simple feature columns (sfc)<a class="anchor" aria-label="anchor" href="#sfc"><i class="fas fa-link"></i></a>
</h3>
<p>Un objet <code>sfg</code> ne contient qu’un seul élément géométrique <em>simple feature</em>.
Une colonne de géométrie *simple feature<strong> (<code>sfc</code>) est une liste d’objets <code>sfg</code>, qui peut en outre contenir des informations sur le système de référence des coordonnées utilisé.
Par exemple, pour combiner deux <em>simples features</em> en un seul objet avec deux entités, nous pouvons utiliser la fonction <code><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc()</a></code>.

C’est important car <code>sfc</code> va correspondre à la colonne de géométrie dans les tableaux de données </strong>sf** :</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># POINT sfc</span>
<span class="va">point1</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">point2</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="va">points_sfc</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc</a></span><span class="op">(</span><span class="va">point1</span>, <span class="va">point2</span><span class="op">)</span>
<span class="va">points_sfc</span>
<span class="co">#&gt; Geometry set for 2 features </span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: 1 ymin: 2 xmax: 5 ymax: 3</span>
<span class="co">#&gt; CRS:           NA</span>
<span class="co">#&gt; POINT (5 2)</span>
<span class="co">#&gt; POINT (1 3)</span></code></pre></div>
<p>Dans la plupart des cas, un objet <code>sfc</code> contient des objets du même type géométrique.
Par conséquent, lorsque nous convertissons des objets <code>sfg</code> de type polygone en une colonne géométrique <em>simple feature</em>, nous obtenons également un objet <code>sfc</code> de type polygone, ce qui peut être vérifié avec <code><a href="https://r-spatial.github.io/sf/reference/st_geometry_type.html">st_geometry_type()</a></code>.
De même, une colonne géométrique de multilignes donnera un objet <code>sfc</code> de type multiligne :</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># sfc POLYGON</span>
<span class="va">polygon_list1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">polygon1</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_polygon</a></span><span class="op">(</span><span class="va">polygon_list1</span><span class="op">)</span>
<span class="va">polygon_list2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">polygon2</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_polygon</a></span><span class="op">(</span><span class="va">polygon_list2</span><span class="op">)</span>
<span class="va">polygon_sfc</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc</a></span><span class="op">(</span><span class="va">polygon1</span>, <span class="va">polygon2</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry_type.html">st_geometry_type</a></span><span class="op">(</span><span class="va">polygon_sfc</span><span class="op">)</span>
<span class="co">#&gt; [1] POLYGON POLYGON</span>
<span class="co">#&gt; 18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># sfc MULTILINESTRING</span>
<span class="va">multilinestring_list1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, 
                            <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">multilinestring1</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_multilinestring</a></span><span class="op">(</span><span class="op">(</span><span class="va">multilinestring_list1</span><span class="op">)</span><span class="op">)</span>
<span class="va">multilinestring_list2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">9</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">9</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">7</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span>, 
                            <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">7</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">multilinestring2</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_multilinestring</a></span><span class="op">(</span><span class="op">(</span><span class="va">multilinestring_list2</span><span class="op">)</span><span class="op">)</span>
<span class="va">multilinestring_sfc</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc</a></span><span class="op">(</span><span class="va">multilinestring1</span>, <span class="va">multilinestring2</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry_type.html">st_geometry_type</a></span><span class="op">(</span><span class="va">multilinestring_sfc</span><span class="op">)</span>
<span class="co">#&gt; [1] MULTILINESTRING MULTILINESTRING</span>
<span class="co">#&gt; 18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE</span></code></pre></div>
<p>C’est aussi possible de créer un objet <code>sfc</code> à partir d’objets <code>sfg</code> de géométries différentes.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># GEOMETRIE sfc </span>
<span class="va">point_multilinestring_sfc</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc</a></span><span class="op">(</span><span class="va">point1</span>, <span class="va">multilinestring1</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry_type.html">st_geometry_type</a></span><span class="op">(</span><span class="va">point_multilinestring_sfc</span><span class="op">)</span>
<span class="co">#&gt; [1] POINT           MULTILINESTRING</span>
<span class="co">#&gt; 18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE</span></code></pre></div>
<p>Comme indiqué précédemment, les objets <code>sfc</code> peuvent également stocker de l’information sur le système de coordonnées et de référence (SCR).
La valeur par défaut est <code>NA</code> (<em>Not Available</em>) et elle peut être vérifiée avec <code><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs()</a></code> :</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">points_sfc</span><span class="op">)</span>
<span class="co">#&gt; Coordinate Reference System: NA</span></code></pre></div>
<p>Toutes les géométries des objets <code>sfc</code> doivent avoir le même SCR.
Un SCR peut être spécifié avec l’argument <code>crs</code> de <code><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc()</a></code> (ou <code><a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf()</a></code>), il prend un <strong>identifiant SCR</strong> fourni sous forme de chaîne de texte, comme <code>crs = "EPSG:4326"</code> (voir la section <a href="#crs-in-r"><strong>??</strong></a> pour détails et mieux comprendre ce que cela signifie)</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Paramètrer le SCR avec un identifiant 'EPSG':</span>
<span class="va">points_sfc_wgs</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc</a></span><span class="op">(</span><span class="va">point1</span>, <span class="va">point2</span>, crs <span class="op">=</span> <span class="st">"EPSG:4326"</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">points_sfc_wgs</span><span class="op">)</span> <span class="co"># indique le SCR (seulement les 4 premières lignes sont montrées)</span>
<span class="co">#&gt; Coordinate Reference System:</span>
<span class="co">#&gt;   User input: EPSG:4326 </span>
<span class="co">#&gt;   wkt:</span>
<span class="co">#&gt; GEOGCRS["WGS 84",</span>
<span class="co">#&gt; ...</span></code></pre></div>
</div>
<div id="le-pacquet-sfheaders" class="section level3" number="2.2.8">
<h3>
<span class="header-section-number">2.2.8</span> le pacquet sfheaders<a class="anchor" aria-label="anchor" href="#le-pacquet-sfheaders"><i class="fas fa-link"></i></a>
</h3>
<p><strong>sfheaders</strong> est un paquet pour R qui accélère la construction, la conversion et la manipulation d’objets <code>sf</code> <span class="citation">(<a href="spatial-class.html#ref-cooley_sfheaders_2020" role="doc-biblioref">Cooley 2020</a>)</span>.
Il se focalise sur la construction rapide d’objets <code>sf</code> à partir de vecteurs, matrices et tableaux de données, sans dépendre de la bibliothèque <strong>sf</strong> ; en exposant son code C++ sous-jacent à travers des fichiers d’en-tête (d’où le nom, <strong>sfheaders</strong>).
Cette approche permet à d’autres de l’étendre en utilisant un code compilé et rapide.
Chaque fonction de base de <strong>sfheaders</strong> a une implémentation C++ correspondante, comme décrit dans <a href="https://dcooley.github.io/sfheaders/articles/Cpp.html">la vignette <code>Cpp</code></a>.
Pour la plupart des gens, les fonctions R seront plus que suffisantes pour bénéficier de la vitesse de calcul du paquet.
<strong>sfheaders</strong> a été développé séparément de <strong>sf</strong>, mais vise à être totalement compatible, en créant des objets <code>sf</code> valides du type décrit dans les sections précédentes.</p>
<p>Les cas le plus simple d’utilisation de <strong>sfheaders</strong> sont présentés dans les morceaux de code ci-dessous avec des exemples de construction d’objets <code>sfg</code>, <code>sfc</code>, et <code>sf</code> :</p>
<ul>
<li>Un vecteur converti en <code>sfg_POINT</code>.</li>
<li>Une matrice convertie en <code>sfg_LINESTRING</code>.</li>
<li>Un cadre de données converti en <code>sfg_POLYGON</code>.</li>
</ul>
<p>Nous allons commencer par créer l’objet <code>sfg</code> le plus simple possible, une seule paire de coordonnées, assignée à un vecteur nommé <code>v</code> :</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">v</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>
<span class="va">v_sfg_sfh</span> <span class="op">=</span> <span class="fu">sfheaders</span><span class="fu">::</span><span class="fu"><a href="https://dcooley.github.io/sfheaders/reference/sfg_point.html">sfg_point</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">v</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">v_sfg_sfh</span> <span class="co"># affichage sans sf chargé</span>
<span class="co">#&gt;      [,1] [,2]</span>
<span class="co">#&gt; [1,]    1    1</span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "XY"    "POINT" "sfg" </span></code></pre></div>
<p>L’exemple ci-dessus montre comment l’objet <code>sfg</code> <code>v_sfg_sfh</code> est affiché lorsque <strong>sf</strong> n’est pas chargé, démontrant ainsi sa structure sous-jacente.
Lorsque <strong>sf</strong> est chargé (comme c’est le cas ici), le résultat de la commande ci-dessus est indiscernable des objets <code>sf</code> :</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">v_sfg_sf</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="va">v</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">v_sfg_sf</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">v_sfg_sfh</span><span class="op">)</span>
<span class="co">#&gt; POINT (1 1)</span>
<span class="co">#&gt; POINT (1 1)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>Les exemples suivants montrent comment <strong>sfheaders</strong> crée des objets <code>sfg</code> à partir de matrices et de tableau de données :</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># matrices</span>
<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu">sfheaders</span><span class="fu">::</span><span class="fu"><a href="https://dcooley.github.io/sfheaders/reference/sfg_linestring.html">sfg_linestring</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">m</span><span class="op">)</span>
<span class="co">#&gt; LINESTRING (1 5, 2 6, 3 7, 4 8)</span>
<span class="co"># data.frames</span>
<span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, y <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>
<span class="fu">sfheaders</span><span class="fu">::</span><span class="fu"><a href="https://dcooley.github.io/sfheaders/reference/sfg_polygon.html">sfg_polygon</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="co">#&gt; POLYGON ((1 4, 2 3, 3 2, 4 1, 1 4))</span></code></pre></div>
<p>En réutilisant les objets <code>v</code>, <code>m</code>, et <code>df</code>, nous pouvons également construire des colonnes de géométrie <em>simple feature</em> (<code>sfc</code>) comme suit (sorties non montrées) :</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">sfheaders</span><span class="fu">::</span><span class="fu"><a href="https://dcooley.github.io/sfheaders/reference/sfc_point.html">sfc_point</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">v</span><span class="op">)</span>
<span class="fu">sfheaders</span><span class="fu">::</span><span class="fu"><a href="https://dcooley.github.io/sfheaders/reference/sfc_linestring.html">sfc_linestring</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">m</span><span class="op">)</span>
<span class="fu">sfheaders</span><span class="fu">::</span><span class="fu"><a href="https://dcooley.github.io/sfheaders/reference/sfc_polygon.html">sfc_polygon</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">df</span><span class="op">)</span></code></pre></div>
<p>De même, les objets <code>sf</code> sont crées comme suis:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">sfheaders</span><span class="fu">::</span><span class="fu"><a href="https://dcooley.github.io/sfheaders/reference/sf_point.html">sf_point</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">v</span><span class="op">)</span>
<span class="fu">sfheaders</span><span class="fu">::</span><span class="fu"><a href="https://dcooley.github.io/sfheaders/reference/sf_linestring.html">sf_linestring</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">m</span><span class="op">)</span>
<span class="fu">sfheaders</span><span class="fu">::</span><span class="fu"><a href="https://dcooley.github.io/sfheaders/reference/sf_polygon.html">sf_polygon</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">df</span><span class="op">)</span></code></pre></div>
<p>Dans chacun de ces exemples, le SCR (système de coordonnées et de référence) n’est pas défini.
Si vous prévoyez d’effectuer des calculs ou des opérations géométriques à l’aide des fonctions <strong>sf</strong>, nous vous recommandons de définir le SCR (voir le chapitre <a href="#reproj-geo-data"><strong>??</strong></a> pour plus de détails) :</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_sf</span> <span class="op">=</span> <span class="fu">sfheaders</span><span class="fu">::</span><span class="fu"><a href="https://dcooley.github.io/sfheaders/reference/sf_polygon.html">sf_polygon</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">df_sf</span><span class="op">)</span> <span class="op">=</span> <span class="st">"EPSG:4326"</span></code></pre></div>
<p><strong>sfheaders</strong> est aussi une bonne option pour “déconstruire” et “reconstruire” les objets <code>sf</code>, c’est-à-dire convertir les colonnes géométriques en tableaux de données contenant les coordonnées de chaque sommet (vertex) et les identifiants de chaque éléments géométriques (et d’éventuels géométrie multiples).
Il est rapide et fiable pour “passer” des colonnes géométriques vers différents types, un sujet traité dans le chapitre <a href="#geometric-operations"><strong>??</strong></a>.
Des tests, dans la <a href="https://dcooley.github.io/sfheaders/articles/examples.html#performance">documentation</a> du paquet et dans le code de test développé pour ce livre, montrent qu’il est beaucoup plus rapide que le paquet <code>sf</code> pour de telles opérations.</p>
</div>
<div id="s2" class="section level3" number="2.2.9">
<h3>
<span class="header-section-number">2.2.9</span> géométrie sphérique avec S2<a class="anchor" aria-label="anchor" href="#s2"><i class="fas fa-link"></i></a>
</h3>
<p>Les moteurs de géométrie sphérique sont basés sur le fait que la terre est ronde alors que les procédures mathématiques simples de géocomputation, telles que le calcul d’une ligne droite entre deux points ou de l’aire délimitée par un polygone, supposent des géométries planes (projetées).
Depuis la version 1.0.0 de <strong>sf</strong>, R prend en charge les opérations de géométrie sphérique “d’emblée”, grâce à son interface avec le moteur de géométrie sphérique S2 de Google, via le paquet l’interfaçant <strong>s2</strong>.
S2 est peut-être mieux connu comme un exemple de système de grille globale discrète (DGGS).
Un autre exemple est l’indice spatial hiérarchique hexagonal global <a href="https://eng.uber.com/h3/">H3</a> <span class="citation">(<a href="spatial-class.html#ref-bondaruk_assessing_2020" role="doc-biblioref">Bondaruk, Roberts, and Robertson 2020</a>)</span>.</p>
<p>Bien que potentiellement utile pour décrire des lieux n’importe où sur la Terre en utilisant des chaînes de caractères telles que <a href="https://developers.google.com/maps/documentation/gaming/concepts_playable_locations">e66ef376f790adf8a5af7fca9e6e422c03c9143f</a>, le principal avantage de l’interface de <strong>sf</strong> avec S2 est l’intégration de fonctions de calculs tels que les calculs de distance, de tampon (buffer) et de surface. Ils sont décrit dans la documentation intégrée de <strong>sf</strong> qui peut être ouverte avec la commande <a href="https://r-spatial.github.io/sf/articles/sf7.html"><code>vignette("sf7")</code></a>.</p>
<p><strong>sf</strong> peut fonctionner sur deux modes par rapport à S2 : activé et désactivé.
Par défaut, le moteur de géométrie S2 est activé, comme on peut le vérifier avec la commande suivante :</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html">sf_use_s2</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>Un exemple des conséquences de la désactivation du moteur de géométrie est montré ci-dessous, en créant des tampons autour de l’objet <code>india</code> créé plus tôt dans le chapitre (notez les avertissements émis lorsque S2 est désactivé)</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">india_buffer_with_s2</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_buffer</a></span><span class="op">(</span><span class="va">india</span>, <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html">sf_use_s2</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Spherical geometry (s2) switched off</span>
<span class="va">india_buffer_without_s2</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_buffer</a></span><span class="op">(</span><span class="va">india</span>, <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; Warning in st_buffer.sfc(st_geometry(x), dist, nQuadSegs, endCapStyle =</span>
<span class="co">#&gt; endCapStyle, : st_buffer does not correctly buffer longitude/latitude data</span>
<span class="co">#&gt; dist is assumed to be in decimal degrees (arc_degrees).</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:s2example"></span>
<img src="02-spatial-data_files/figure-html/s2example-1.png" alt="Exemple des conséquences de la désactivation du moteur géométrique S2. Les deux représentations d'un tampon autour de l'Inde ont été créées avec la même commande, mais l'objet polygone violet a été créé avec S2 activé, ce qui a donné un tampon de 1 m. Le polygone vert clair, plus grand, a été créé avec S2 désactivé, ce qui a donné un tampon inexacte avec des degrés en longitude/latitude." width="100%"><p class="caption">
FIGURE 2.11: Exemple des conséquences de la désactivation du moteur géométrique S2. Les deux représentations d’un tampon autour de l’Inde ont été créées avec la même commande, mais l’objet polygone violet a été créé avec S2 activé, ce qui a donné un tampon de 1 m. Le polygone vert clair, plus grand, a été créé avec S2 désactivé, ce qui a donné un tampon inexacte avec des degrés en longitude/latitude.
</p>
</div>
<p>Dans ce livre, nous supposerons que S2 est activé, sauf indication contraire.
Activez-le à nouveau avec la commande suivante.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html">sf_use_s2</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Spherical geometry (s2) switched on</span></code></pre></div>

<div class="rmdnote">
Bien que l’utilisation de S2 par <strong>sf</strong> ait du sens dans de nombreux cas, dans certains cas, il y a de bonnes raisons de désactiver S2 pour la durée d’une session R ou même pour un projet entier.
Comme documenté dans la question <a href="https://github.com/r-spatial/sf/issues/1771">1771</a> dans le repo GitHub de <strong>sf</strong>, le comportement par défaut peut faire échouer du code qui fonctionnerait avec S2 désactivé (et avec des versions plus anciennes de <strong>sf</strong>).
Ces cas limites incluent des opérations sur des polygones qui ne sont pas valides selon la définition plus stricte de S2.
Si vous voyez un message d’erreur tel que <code>#&gt; Error in s2_geography_from_wkb ...</code>, il peut être utile de réessayer la commande qui a généré le message d’erreur, après avoir désactivé S2.
Pour désactiver S2 pour la totalité d’un projet, vous pouvez créer un fichier appelé .Rprofile dans le répertoire racine (le dossier principal) de votre projet contenant la commande <code>sf::sf_use_s2(FALSE)</code>.
</div>
</div>
</div>
<div id="données-raster" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Données Raster<a class="anchor" aria-label="anchor" href="#donn%C3%A9es-raster"><i class="fas fa-link"></i></a>
</h2>
<p>Le modèle de données raster représente le monde à l’aide d’une grille continue de cellules (souvent aussi appelées pixels ; Figure <a href="spatial-class.html#fig:raster-intro-plot">2.12</a>:A).
Ce modèle de données fait souvent référence à des grilles dites régulières, dans lesquelles chaque cellule a une taille identique et constante - et nous nous concentrerons uniquement sur les grilles régulières dans cet ouvrage.
Cependant, plusieurs autres types de grilles existent, notamment les grilles tournées, cisaillées, rectilignes et curvilignes (voir le chapitre 1 de <span class="citation">Pebesma and Bivand (<a href="spatial-class.html#ref-pebesma_spatial_2022" role="doc-biblioref">2022</a>)</span> ou le chapitre 2 de <span class="citation">Tennekes and Nowosad (<a href="spatial-class.html#ref-tennekes_elegant_2022" role="doc-biblioref">2022</a>)</span>).</p>
<p>Un raster se compose généralement d’un en-tête
et d’une matrice (avec des lignes et des colonnes) représentant des cellules équidistantes (souvent aussi nommées pixels; Figure <a href="spatial-class.html#fig:raster-intro-plot">2.12</a>:A).)<a href="spatial-class.html#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a>
L’en-tête du raster définit le système de coordonnées et références, l’étendue et l’origine.


L’origine (ou point de départ) est souvent la coordonnée du coin inférieur gauche de la matrice (LE paquet <strong>terra</strong> utilise toutefois le coin supérieur gauche, par défaut (Figure <a href="spatial-class.html#fig:raster-intro-plot">2.12</a>:B)).
L’en-tête définit l’étendue via le nombre de colonnes, le nombre de lignes et la résolution de la taille des cellules.
Ainsi, en partant de l’origine, nous pouvons facilement accéder à chaque cellule et la modifier, soit en utilisant l’ID d’une cellule (Figure <a href="spatial-class.html#fig:raster-intro-plot">2.12</a>:B), soit en spécifiant explicitement les lignes et les colonnes.
Cette représentation matricielle évite de stocker explicitement les coordonnées des quatre points d’angle (en fait, elle ne stocke qu’une seule coordonnée, à savoir l’origine) de chaque coin de cellule, comme ce serait le cas pour les polygones vectoriels rectangulaires.
Grâce à cela et à l’algèbre matricielle (section <a href="#map-algebra"><strong>??</strong></a>), le traitement raster est beaucoup plus efficace et rapide que le traitement des données vectorielles.
Cependant, contrairement aux données vectorielles, la cellule d’une couche raster ne peut contenir qu’une seule valeur.
Cette valeur peut être numérique ou catégorique (Figure <a href="spatial-class.html#fig:raster-intro-plot">2.12</a>:C).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:raster-intro-plot"></span>
<img src="02-spatial-data_files/figure-html/raster-intro-plot-1.png" alt="Données raster types: (A) identifiant des pixels, (B) Valeur des pixels, (C) une carte raster colorisée." width="100%"><p class="caption">
FIGURE 2.12: Données raster types: (A) identifiant des pixels, (B) Valeur des pixels, (C) une carte raster colorisée.
</p>
</div>
<p>Les rasters représentent généralement des phénomènes continus tels que l’élévation, la température, la densité de population ou des données spectrales.
Les variables discrètes telles que les classes de sol ou de couverture terrestre peuvent également être représentées dans le modèle de données raster.
Ces deux utilisations sont illustrées dans la figure <a href="spatial-class.html#fig:raster-intro-plot2">2.13</a>, elle montre comment les limites des caractéristiques discrètes peuvent devenir floues dans les ensembles de données matricielles.
Selon la nature de l’application, les représentations vectorielles des caractéristiques discrètes peuvent être plus adaptées.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:raster-intro-plot2"></span>
<img src="02-spatial-data_files/figure-html/raster-intro-plot2-1.png" alt="Exemples de rasters pour des variables continues et catégorielles." width="100%"><p class="caption">
FIGURE 2.13: Exemples de rasters pour des variables continues et catégorielles.
</p>
</div>
<div id="les-paquets-de-r-pour-travailler-avec-des-rasters" class="section level3" number="2.3.1">
<h3>
<span class="header-section-number">2.3.1</span> Les paquets de R pour travailler avec des rasters<a class="anchor" aria-label="anchor" href="#les-paquets-de-r-pour-travailler-avec-des-rasters"><i class="fas fa-link"></i></a>
</h3>
<p>Au cours des deux dernières décennies, plusieurs paquets permettant de lire et de traiter des ensembles de données matricielles ont été développés.
Comme indiqué dans la section <a href="intro.html#the-history-of-r-spatial">1.5</a>, le principal d’entre eux était <strong>raster</strong>. Il a conduit à un changement radical dans les capacités de traitement des rasters avec R lorsqu’il a été lancé en 2010 et il a dominé ce segment jusqu’au développement de <strong>terra</strong> et <strong>stars</strong>.
Les deux paquets développés plus récemment offrent des fonctions puissantes et performantes pour travailler avec des jeux de données raster et ils ont d’important recoupement entre leurs cas d’usages.
Dans ce livre, nous nous concentrons sur <strong>terra</strong>, qui remplace <strong>raster</strong>, plus ancien et (dans la plupart des cas) plus lent.
Avant de découvrir le fonctionnement du système de classes de <strong>terra</strong>, cette section décrit les similitudes et les différences entre <strong>terra</strong> et <strong>stars</strong> ; ces connaissances aideront à décider lequel est le plus approprié dans différentes situations.</p>
<p>Tout d’abord, <strong>terra</strong> se concentre sur le modèle de données raster le plus courant (grilles régulières), tandis que <strong>stars</strong> permet également de stocker des modèles moins populaires (notamment des grilles régulières, tournées, cisaillées, rectilignes et curvilignes).
Alors que <strong>terra</strong> gère généralement des rasters à une ou plusieurs couches<a href="spatial-class.html#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a>, le paquet <strong>stars</strong> fournit des moyens de stocker des cubes de données raster – un objet raster avec de nombreuses couches (par exemple, des bandes), pour de nombreux moments dans le temps (par exemple, des mois), et de nombreux attributs (par exemple, le type de capteur A et le type de capteur B).
Premièrement, il est important de noter que dans les deux paquets, toutes les couches ou éléments d’un cube de données doivent avoir les mêmes dimensions spatiales et la même étendue.
Deuxièmement, les deux paquets permettent soit de lire toutes les données raster en mémoire, soit de lire uniquement leurs métadonnées, ce qui est généralement effectué automatiquement en fonction de la taille du fichier d’entrée.
Cependant, ils stockent raster de manière très différente.
<strong>terra</strong> est basé sur du code C++ et utilise principalement des pointeurs C++.
<strong>stars</strong> stocke les valeurs sous forme de listes de tableaux pour les plus petits rasters ou juste un chemin de fichier pour les plus grands.
Troisièmement, les fonctions de <strong>stars</strong> sont étroitement liées aux objets et fonctions vectorielles de <strong>sf</strong>, alors que <strong>terra</strong> utilise sa propre classe d’objets pour les données vectorielles, à savoir <code>SpatVector</code>.
Quatrièmement, les deux paquets approchent différemment la façon dont leurs fonctions agissent sur leurs objets.
Le paquet <strong>terra</strong> s’appuie principalement sur un grand nombre de fonctions intégrées, où chaque fonction a un but spécifique (par exemple, le rééchantillonnage ou le recadrage).
De son coté <strong>stars</strong> utilise quelques fonctions intégrées (généralement avec des noms commençant par <code>st_</code>) avec en complément de ses propres méthodes pour les fonctions de R existantes (par exemple, <code><a href="https://rdrr.io/pkg/terra/man/split.html">split()</a></code> ou <code><a href="https://rdrr.io/pkg/sp/man/aggregate.html">aggregate()</a></code>), et des méthodes pour les fonctions de <strong>dplyr</strong> (par exemple, <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> ou <code>slice()</code>).</p>
<p>Il est important de noter qu’il est facile de convertir des objets de <strong>terra</strong> en <strong>stars</strong> (en utilisant <code>st_as_stars()</code>) et inversement (en utilisant <code><a href="https://rdrr.io/pkg/terra/man/rast.html">rast()</a></code>).
Nous vous encourageons également à lire <span class="citation">Pebesma and Bivand (<a href="spatial-class.html#ref-pebesma_spatial_2022" role="doc-biblioref">2022</a>)</span> pour l’introduction la plus complète au paquet <strong>stars</strong>.</p>
</div>
<div id="une-introduction-à-terra" class="section level3" number="2.3.2">
<h3>
<span class="header-section-number">2.3.2</span> Une introduction à terra<a class="anchor" aria-label="anchor" href="#une-introduction-%C3%A0-terra"><i class="fas fa-link"></i></a>
</h3>
<p>Le paquet <strong>terra</strong> prend en charge les objets raster dans R.
Comme son prédécesseur <strong>raster</strong> (créé par le même développeur, Robert Hijmans), il fournit un ensemble complet de fonctions pour créer, lire, exporter, manipuler et traiter des jeux de données rasters.
Les fonctionnalités de <strong>terra</strong> sont en grande partie les mêmes que celles du paquetage <strong>raster</strong>, plus mature, mais il existe quelques différences : Les fonctions <strong>terra</strong> sont généralement plus efficientes en calcul que les équivalents <strong>raster</strong>.
<!-- todo : ajouter des preuves (RL 2021-11) -->
D’autre part, le système de classes de <strong>raster</strong> est populaire et utilisé par de nombreux autres paquets.
Vous pouvez passer sans problème d’un type d’objet à l’autre pour assurer la compatibilité avec les anciens scripts et paquets, par exemple avec les fonctions <a href="https://rspatial.github.io/raster/reference/raster.html"><code>raster()</code></a>, <a href="https://rspatial.github.io/raster/reference/stack.html"><code>stack()</code></a> et <code>brick()</code> du paquet <strong>raster</strong> (cf. le chapitre précédent pour en savoir plus sur l’évolution des paquets R pour travailler avec des données géographiques).</p>
<p>En plus des fonctions de manipulation des données matricielles, <strong>terra</strong> fournit de nombreuses fonctions de bas niveau pouvant servir de base au développement de nouveaux outils pour travailler avec des jeux de données raster.

<strong>terra</strong> vous permet également de travailler sur de grands jeux de données raster qui sont trop volumineux pour tenir dans la RAM.
Dans ce cas, <strong>terra</strong> offre la possibilité de diviser l’image raster en petits morceaux et de les traiter de manière itérative au lieu de charger un fichier entier dans la RAM.</p>
<p>Pour l’illustration des concepts <strong>terra</strong>, nous utiliserons des jeux de données de la <strong>spDataLarge</strong>.
Il s’agit de quelques objets raster et d’un objet vectoriel couvrant une zone du parc national de Zion (Utah, USA).
Par exemple, <code>srtm.tif</code> est un modèle numérique d’élévation de cette zone (pour plus de détails, voir sa documentation <code>?srtm</code>).
Tout d’abord, créons un objet <code>SpatRaster</code> nommé <code>my_rast</code> :</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">raster_filepath</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"raster/srtm.tif"</span>, package <span class="op">=</span> <span class="st">"spDataLarge"</span><span class="op">)</span>
<span class="va">my_rast</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">raster_filepath</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">my_rast</span><span class="op">)</span>
<span class="co">#&gt; [1] "SpatRaster"</span>
<span class="co">#&gt; attr(,"package")</span>
<span class="co">#&gt; [1] "terra"</span></code></pre></div>
<p>En tapant le nom du raster dans la console, on obtient l’en-tête du raster (dimensions, résolution, étendue, CRS) et quelques informations supplémentaires (classe, source de données, résumé des valeurs du raster) :</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_rast</span>
<span class="co">#&gt; class       : SpatRaster </span>
<span class="co">#&gt; dimensions  : 457, 465, 1  (nrow, ncol, nlyr)</span>
<span class="co">#&gt; resolution  : 0.000833, 0.000833  (x, y)</span>
<span class="co">#&gt; extent      : -113, -113, 37.1, 37.5  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span>
<span class="co">#&gt; source      : srtm.tif </span>
<span class="co">#&gt; name        : srtm </span>
<span class="co">#&gt; min value   : 1024 </span>
<span class="co">#&gt; max value   : 2892</span></code></pre></div>
<p>Des fonctions dédiées renseignent chaque composant : <code>dim(my_rast)</code> renvoie le nombre de lignes, de colonnes et de couches ; <code><a href="https://rdrr.io/pkg/terra/man/dimensions.html">ncell()</a></code> le nombre de cellules (pixels) ; <code><a href="https://rdrr.io/pkg/terra/man/dimensions.html">res()</a></code> la résolution spatiale ; <code><a href="https://rdrr.io/pkg/terra/man/ext.html">ext()</a></code> son étendue spatiale ; et <code><a href="https://rdrr.io/pkg/terra/man/crs.html">crs()</a></code> son système de référence de coordonnées (la reprojection matricielle est traitée dans la section <a href="#reproj-ras"><strong>??</strong></a>).
<code><a href="https://rdrr.io/pkg/terra/man/sources.html">inMemory()</a></code> indique si le raster est stocké en mémoire vive ou sur disque.</p>
<p><code><a href="https://rdrr.io/pkg/terra/man/terra-package.html">help("terra-package")</a></code> renvoie une liste complète de toutes les fonctions <strong>terra</strong> disponibles.</p>
</div>
<div id="basic-map-raster" class="section level3" number="2.3.3">
<h3>
<span class="header-section-number">2.3.3</span> Réalisation de cartes de base<a class="anchor" aria-label="anchor" href="#basic-map-raster"><i class="fas fa-link"></i></a>
</h3>
<p>Comme le paquet <strong>sf</strong>, <strong>terra</strong> fournit également des méthodes <code><a href="https://rdrr.io/pkg/terra/man/plot.html">plot()</a></code> pour ses propres classes.
</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">my_rast</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:basic-new-raster-plot"></span>
<img src="02-spatial-data_files/figure-html/basic-new-raster-plot-1.png" alt="Basic raster plot." width="100%"><p class="caption">
FIGURE 2.14: Basic raster plot.
</p>
</div>
<p>Il existe plusieurs autres approches pour représenter des données raster dans R qui sortent du cadre de cette section, notamment :</p>
<ul>
<li>la fonction <code><a href="https://rdrr.io/pkg/terra/man/plotRGB.html">plotRGB()</a></code> du paquet <strong>terra</strong> pour créer <em>une composition colorée rouge-vert-bleu (RGB)</em> basée sur trois couches dans un objet <code>SpatRaster</code>.</li>
<li>Des paquets tels que <strong>tmap</strong> pour créer des cartes statiques et interactives d’objets rasters et vectoriels (voir le chapitre <a href="#adv-map"><strong>??</strong></a>)</li>
<li>D’autres fonctions, par exemple <code>levelplot()</code> du paquet <strong>rasterVis</strong>, pour créer des vignettes, une technique courante pour visualiser les changements dans le temps.</li>
</ul>
</div>
<div id="raster-classes" class="section level3" number="2.3.4">
<h3>
<span class="header-section-number">2.3.4</span> Les classes Raster<a class="anchor" aria-label="anchor" href="#raster-classes"><i class="fas fa-link"></i></a>
</h3>
<p>La classe <code>SpatRaster</code> représente les rasters dans <strong>terra</strong>.
La façon la plus simple de créer un objet raster dans R est de lire un fichier raster à partir du disque ou d’un serveur (Section <a href="#raster-data-read"><strong>??</strong></a>.
</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">single_raster_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"raster/srtm.tif"</span>, package <span class="op">=</span> <span class="st">"spDataLarge"</span><span class="op">)</span>
<span class="va">single_rast</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">raster_filepath</span><span class="op">)</span></code></pre></div>
<p>Le paquet <strong>terra</strong> supporte de nombreux pilotes à l’aide de la bibliothèque GDAL.
Les rasters provenant de fichiers ne sont généralement pas lus entièrement en RAM, à l’exception de leur en-tête et d’un pointeur vers le fichier lui-même.</p>
<p>Les rasters peuvent aussi être créés à partir de zéro en utilisant la même fonction <code><a href="https://rdrr.io/pkg/terra/man/rast.html">rast()</a></code>.
Ceci est illustré dans l’extrait de code suivant produisant en un nouvel objet <code>SpatRaster</code>.
Ce raster consiste en 36 cellules (6 colonnes et 6 lignes spécifiées par <code>nrows</code> et <code>ncols</code>) centrées autour du Méridien d’origine et de l’Équateur (voir les paramètres <code>xmin</code>, <code>xmax</code>, <code>ymin</code> et <code>ymax</code>).
Le SCR par défaut des objets rasters est WGS84, mais peut être changé avec l’argument <code>crs</code>.
Cela signifie que l’unité de résolution est en degrés, que nous fixons à 0.5 (<code>resolution</code>).
Des valeurs (<code>vals</code>) sont assignées à chaque cellule : 1 à la cellule 1, 2 à la cellule 2, et ainsi de suite.
Rappelez-vous : <code><a href="https://rdrr.io/pkg/terra/man/rast.html">rast()</a></code> remplit les cellules par rangées (contrairement à <code><a href="https://rdrr.io/r/base/matrix.html">matrix()</a></code>) en commençant par le coin supérieur gauche, ce qui signifie que la première rangée contient les valeurs 1 à 6, la seconde 7 à 12, etc.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_raster</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span>nrows <span class="op">=</span> <span class="fl">6</span>, ncols <span class="op">=</span> <span class="fl">6</span>, resolution <span class="op">=</span> <span class="fl">0.5</span>, 
                  xmin <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>, xmax <span class="op">=</span> <span class="fl">1.5</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>, ymax <span class="op">=</span> <span class="fl">1.5</span>,
                  vals <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">36</span><span class="op">)</span></code></pre></div>
<p><code><a href="https://rdrr.io/pkg/terra/man/rast.html">?rast</a></code> permet de découvrir d’autre facons de créer des objets rasters.</p>
<p>La classe <code>SpatRaster</code> gère également les couches multiples, qui correspondent généralement à un seul fichier satellite multispectral ou à une série temporelle de rasters.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">multi_raster_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"raster/landsat.tif"</span>, package <span class="op">=</span> <span class="st">"spDataLarge"</span><span class="op">)</span>
<span class="va">multi_rast</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">multi_raster_file</span><span class="op">)</span>
<span class="va">multi_rast</span>
<span class="co">#&gt; class       : SpatRaster </span>
<span class="co">#&gt; dimensions  : 1428, 1128, 4  (nrow, ncol, nlyr)</span>
<span class="co">#&gt; resolution  : 30, 30  (x, y)</span>
<span class="co">#&gt; extent      : 301905, 335745, 4111245, 4154085  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; coord. ref. : WGS 84 / UTM zone 12N (EPSG:32612) </span>
<span class="co">#&gt; source      : landsat.tif </span>
<span class="co">#&gt; names       : landsat_1, landsat_2, landsat_3, landsat_4 </span>
<span class="co">#&gt; min values  :      7550,      6404,      5678,      5252 </span>
<span class="co">#&gt; max values  :     19071,     22051,     25780,     31961</span></code></pre></div>
<p><code><a href="https://rdrr.io/pkg/terra/man/dimensions.html">nlyr()</a></code> fournit le nombre de couches stockées dans un objet <code>SpatRaster</code> :</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">nlyr</a></span><span class="op">(</span><span class="va">multi_rast</span><span class="op">)</span>
<span class="co">#&gt; [1] 4</span></code></pre></div>
<p>Pour les objets raster multi-couches, les couches peuvent être sélectionnées avec <code><a href="https://rdrr.io/pkg/terra/man/subset.html">terra::subset()</a></code>.<a href="spatial-class.html#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a>.
Elle accepte un numéro de couche ou son nom comme second argument :</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">multi_rast3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/subset.html">subset</a></span><span class="op">(</span><span class="va">multi_rast</span>, <span class="fl">3</span><span class="op">)</span>
<span class="va">multi_rast4</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/subset.html">subset</a></span><span class="op">(</span><span class="va">multi_rast</span>, <span class="fl">4</span><span class="op">)</span></code></pre></div>
<p>L’opération inverse, qui consiste à combiner plusieurs objets <code>SpatRaster</code> en un seul, peut être réalisée à l’aide de la fonction <code>c</code> :</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">multi_rast34</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="va">multi_rast3</span>, <span class="va">multi_rast4</span><span class="op">)</span></code></pre></div>

<div class="rmdnote">
La plupart des objets <code>SpatRaster</code> ne stockent pas des rasters, mais plutôt un pointeur vers le fichier lui-même.
Cela a un effet secondaire important : ils ne peuvent pas être directement sauvegardés dans des fichiers <code>".rds"</code> ou <code>".rda"</code> ou utilisés dans le calcul en grappe.
Dans ces cas, il y a deux solutions possibles : (1) l´utilisation de la fonction <code><a href="https://rdrr.io/pkg/terra/man/wrap.html">wrap()</a></code> qui crée un type spécial d´objet temporaire qui peut être sauvegardé comme un objet R ou utilisé dans des grappe de serveurs, ou (2) sauvegarder l´objet comme un raster régulier avec <code><a href="https://rdrr.io/pkg/terra/man/writeRaster.html">writeRaster()</a></code>.
</div>
<!--jn:toDo-->
<!--consider new section with other data models-->
<!-- e.g. point clouds, data cubes, meshes, etc. -->
</div>
</div>
<div id="crs-intro" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> Système de Coordonnés et de Réferences géographiques et projetés<a class="anchor" aria-label="anchor" href="#crs-intro"><i class="fas fa-link"></i></a>
</h2>
<p>
Les types de données spatiales vectorielles et rasters partagent des concepts intrinsèques aux données spatiales.
Le plus fondamental d’entre eux est peut-être le système de référence des coordonnées (SCR), qui définit la manière dont les éléments spatiaux des données se rapportent à la surface de la Terre (ou d’autres corps).
Les CRS sont soit géographiques, soit projetés, comme nous l’avons présenté au début de ce chapitre (voir Figure <a href="spatial-class.html#fig:vectorplots">2.1</a>).
Cette section reprend chaque type, posant ainsi les bases du chapitre <a href="#reproj-geo-data"><strong>??</strong></a>, qui offre une plongée en profondeur dans la configuration, la transformation et l’interrogation des SCR.</p>
<div id="système-de-référence-des-coordonnées" class="section level3" number="2.4.1">
<h3>
<span class="header-section-number">2.4.1</span> Système de référence des coordonnées<a class="anchor" aria-label="anchor" href="#syst%C3%A8me-de-r%C3%A9f%C3%A9rence-des-coordonn%C3%A9es"><i class="fas fa-link"></i></a>
</h3>
<p>
Les systèmes de coordonnées géographiques identifient tout emplacement sur la surface de la Terre à l’aide de deux valeurs — la longitude et la latitude (voir le panneau gauche de la figure <a href="spatial-class.html#fig:vector-crs">2.16</a>).
<em>La longitude</em> est la position dans la direction est-ouest en distance angulaire par rapport au plan du méridien d’origine.
<em>La latitude</em> est la distance angulaire au nord ou au sud du plan équatorial.
Les distances dans les SCR géographiques ne sont donc pas mesurées en mètres.
Cela a des conséquences importantes, comme le montre la section <a href="#reproj-geo-data"><strong>??</strong></a>.</p>
<p>La surface de la Terre dans les systèmes de coordonnées géographiques est représentée par une surface sphérique ou ellipsoïdale.
Les modèles sphériques supposent que la Terre est une sphère parfaite d’un rayon donné. Ils ont l’avantage de la simplicité mais, en même temps, ils sont inexacts : la Terre n’est pas une sphère !
Les modèles ellipsoïdaux sont définis par deux paramètres : le rayon équatorial et le rayon polaire.
Ils sont adaptés car la Terre est comprimée : le rayon équatorial est environ 11,5 km plus long que le rayon polaire <span class="citation">(<a href="spatial-class.html#ref-maling_coordinate_1992" role="doc-biblioref">Maling 1992</a>)</span>.<a href="spatial-class.html#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a></p>
<p>Les ellipsoïdes font partie d’un composant plus large des SCR : le <em>datum</em>.
Il contient des informations sur l’ellipsoïde à utiliser et la relation précise entre les coordonnées cartésiennes et l’emplacement sur la surface de la Terre.
Il existe deux types de datum — géocentrique (tel que <code>WGS84</code>) et local (tel que <code>NAD83</code>).
Vous pouvez voir des exemples de ces deux types de référentiels dans la figure <a href="spatial-class.html#fig:datum-fig">2.15</a>.
Les lignes noires représentent un * datum géocentrique<em>, dont le centre est situé au centre de gravité de la Terre et n’est pas optimisé pour un emplacement spécifique.
Dans un </em>datum référentiel*, représenté par une ligne pointillée violette, la surface ellipsoïdale est décalée pour s’aligner sur la surface à un endroit particulier.
Cela permet de prendre en compte les variations locales de la surface de la Terre, dues par exemple à de grandes chaînes de montagnes, dans un SCR local.
On peut le voir sur la figure <a href="spatial-class.html#fig:datum-fig">2.15</a>, où le système de référence local est adapté à la région des Philippines, mais n’est pas aligné avec la majeure partie du reste de la surface de la planète.
Les deux référentiels de la figure <a href="spatial-class.html#fig:datum-fig">2.15</a> sont placés au-dessus d’un géoïde - un modèle du niveau moyen des mers à l’échelle mondiale <a href="spatial-class.html#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a>.</p>

<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:datum-fig"></span>
<img src="figures/02_datum_fig.png" alt="Données géocentriques et géodésiques locales représentées sur un géoïde (en fausses couleurs et avec un facteur d’échelle de 10 000 pour l’exagération verticale). L’image du géoïde est adaptée du travail de Ince et al. (2019)." width="100%"><p class="caption">
FIGURE 2.15: Données géocentriques et géodésiques locales représentées sur un géoïde (en fausses couleurs et avec un facteur d’échelle de 10 000 pour l’exagération verticale). L’image du géoïde est adaptée du travail de <span class="citation">Ince et al. (<a href="spatial-class.html#ref-essd-11-647-2019" role="doc-biblioref">2019</a>)</span>.
</p>
</div>
</div>
<div id="système-de-réference-projetées" class="section level3" number="2.4.2">
<h3>
<span class="header-section-number">2.4.2</span> Système de réference projetées<a class="anchor" aria-label="anchor" href="#syst%C3%A8me-de-r%C3%A9ference-projet%C3%A9es"><i class="fas fa-link"></i></a>
</h3>
<p>
Tous les SCR projetés sont basés sur un SCR géographique, décrit dans la section précédente, et s’appuient sur des projections cartographiques pour convertir la surface tridimensionnelle de la Terre en valeurs d’abscisses et d’ordonnées (x et y) dans un SCR projeté.
Les SRC projetés sont basés sur des coordonnées cartésiennes sur une surface implicitement plane (panneau de droite de la figure <a href="spatial-class.html#fig:vector-crs">2.16</a>).
Ils ont une origine, des axes x et y, et une unité de mesure linéaire telle que le mètre.</p>
<p>Cette transition ne peut se faire sans ajouter certaines déformations.
Par conséquent, certaines propriétés de la surface de la Terre sont déformées au cours de ce processus, telles que la superficie, la direction, la distance et la forme.
Un système de coordonnées projeté ne peut préserver qu’une ou deux de ces propriétés.
Les projections sont souvent nommées en fonction de la propriété qu’elles préservent : la projection de surface égale préserve l’aire, la projection azimutale préserve la direction, la projection équidistante préserve la distance et la projection conforme préserve la forme locale.</p>
<p>Il existe trois groupes principaux de types de projection : conique, cylindrique et plane (azimutale).
Dans une projection conique, la surface de la Terre est projetée sur un cône le long d’une seule ligne de tangence ou de deux lignes de tangence.
Les distorsions sont minimisées le long des lignes de tangence et augmentent avec la distance à ces lignes dans cette projection.
Elle est donc le mieux adaptée aux cartes des zones de latitude moyenne.
Une projection cylindrique représente la surface sur un cylindre.
Cette projection peut également être créée en touchant la surface de la Terre le long d’une seule ligne de tangence ou de deux lignes de tangence.
Les projections cylindriques sont le plus souvent utilisées pour cartographier le monde entier.
Une projection plane projette les données sur une surface plate en touchant le globe en un point ou le long d’une ligne de tangence.
Elle est généralement utilisée pour cartographier les régions polaires.
<code>sf_proj_info(type = "proj")</code> donne une liste des projections disponibles supportées par la bibliothèque PROJ.</p>
<p>Un résumé rapide des différentes projections, de leurs types, de leurs propriétés et de leur adéquation peut être trouvé dans <span class="citation"><span>“Map Projections”</span> (<a href="spatial-class.html#ref-_map_1993" role="doc-biblioref">1993</a>)</span> et sur <a href="https://www.geo-projections.com/" class="uri">https://www.geo-projections.com/</a>.
Nous nous étendrons sur les SCR et expliquerons comment projeter d’un SCR à un autre dans le chapitre <a href="#reproj-geo-data"><strong>??</strong></a>.
Pour l’instant, il suffit de savoir :</p>
<ul>
<li>Les systèmes de coordonnées sont un élément clé des objets géographiques.</li>
<li>Il est important de savoir dans quel SCR se trouvent vos données, et s’il s’agit d’un système géographique (lon/lat) ou d’un système projeté (généralement en mètres), car cela a des conséquences sur la façon dont R gère les opérations spatiales et géométriques.</li>
<li>Les SCR des objets <code>sf</code> peuvent être interrogés avec la fonction <code><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs()</a></code>, les SCR des objets <code>terra</code> peuvent être interrogés avec la fonction <code><a href="https://rdrr.io/pkg/terra/man/crs.html">crs()</a></code>.</li>
</ul>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:vector-crs"></span>
<img src="figures/02_vector_crs.png" alt="Exemples de systèmes de coordonnées géographiques (WGS 84 ; à gauche) et projetées (NAD83 / UTM zone 12N ; à droite) pour un type de données vectorielles." width="100%"><p class="caption">
FIGURE 2.16: Exemples de systèmes de coordonnées géographiques (WGS 84 ; à gauche) et projetées (NAD83 / UTM zone 12N ; à droite) pour un type de données vectorielles.
</p>
</div>
</div>
</div>
<div id="unités" class="section level2" number="2.5">
<h2>
<span class="header-section-number">2.5</span> Unités<a class="anchor" aria-label="anchor" href="#unit%C3%A9s"><i class="fas fa-link"></i></a>
</h2>
<!--rl-->
<!-- https://cran.r-project.org/web/packages/units/vignettes/measurement_units_in_R.html -->
<p>Une caractéristique importante des SCR est qu’ils contiennent des informations sur les unités spatiales.
De toute évidence, il est essentiel de savoir si les mesures d’une maison sont en pieds ou en mètres, et il en va de même pour les cartes.
Il est de bonne pratique cartographique d’ajouter une <em>barre d’échelle</em> ou un autre indicateur de distance sur les cartes afin de démontrer la relation entre les distances sur la page ou l’écran et les distances sur le terrain.
De même, il est important de spécifier formellement les unités dans lesquelles les données géométriques ou les cellules sont mesurées afin de fournir un contexte et de garantir que les calculs ultérieurs sont effectués dans ce contexte.</p>
<p>Une nouvelle caractéristique des données géométriques dans les objets <code>sf</code> est qu’elles ont un <em>support natif</em> pour les unités.
Cela signifie que les calculs de distance, de surface et autres calculs géométriques dans <strong>sf</strong> renvoient des valeurs accompagnées d’un attribut <code>units</code>, défini par le paquet <strong>units</strong> <span class="citation">(<a href="spatial-class.html#ref-pebesma_measurement_2016" role="doc-biblioref">Pebesma, Mailund, and Hiebert 2016</a>)</span>.
Ceci est avantageux, car cela évite la confusion causée par les différentes unités (la plupart des SCR utilisent les mètres, certains les pieds) et fournit des informations sur la dimensionnalité.
Ceci est démontré dans le morceau de code ci-dessous, qui calcule la superficie du Luxembourg :

</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">luxembourg</span> <span class="op">=</span> <span class="va">world</span><span class="op">[</span><span class="va">world</span><span class="op">$</span><span class="va">name_long</span> <span class="op">==</span> <span class="st">"Luxembourg"</span>, <span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html">st_area</a></span><span class="op">(</span><span class="va">luxembourg</span><span class="op">)</span> <span class="co"># nécessite le paquet s2 des récentes version de sf</span>
<span class="co">#&gt; 2.41e+09 [m^2]</span></code></pre></div>
<p>La sortie est en unités de mètres carrés (m<sup>2</sup>), montrant que le résultat représente un espace bidimensionnel.
Cette information, stockée sous forme d’attribut (que les lecteurs intéressés peuvent découvrir avec <code>attributs(st_area(luxembourg))</code>), peut alimenter des calculs ultérieurs qui utilisent des unités, comme la densité de population (nombre de personnes par unité de surface, typiquement par km<sup>2</sup>).
Le fait de déclarer les unités permet d’éviter toute confusion.
Pour reprendre l’exemple du Luxembourg, si les unités n’étaient pas précisées, on pourrait supposer à tort que les unités sont en hectares.
Pour traduire ce chiffre énorme en une taille plus digeste, il est tentant de diviser les résultats par un million (le nombre de mètres carrés dans un kilomètre carré)</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html">st_area</a></span><span class="op">(</span><span class="va">luxembourg</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1000000</span>
<span class="co">#&gt; 2409 [m^2]</span></code></pre></div>
<p>Cependant, le résultat est alors donné de manière incorrecte en mètres carrés.
La solution consiste à définir les unités correctes avec le paquet <strong>units</strong> :</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html">set_units</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html">st_area</a></span><span class="op">(</span><span class="va">luxembourg</span><span class="op">)</span>, <span class="va">km</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; 2409 [km^2]</span></code></pre></div>
<p>Les unités sont tout aussi importantes dans le cas des jeux de données raster.
Cependant, jusqu’à présent, <strong>sf</strong> est le seul paquet spatial qui supporte les unités, ce qui signifie que les personnes travaillant sur des données raster doivent aborder les changements d’unités d’analyse (par exemple, la conversion de la largeur des pixels des unités impériales aux unités décimales) avec précaution.
L’objet <code>my_rast</code> (voir ci-dessus) utilise une projection WGS84 avec des degrés décimaux comme unités.
Par conséquent, sa résolution est également donnée en degrés décimaux, mais il faut le savoir, puisque la fonction <code><a href="https://rdrr.io/pkg/terra/man/dimensions.html">res()</a></code> renvoie simplement un vecteur numérique.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">res</a></span><span class="op">(</span><span class="va">my_rast</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.000833 0.000833</span></code></pre></div>
<p>Si nous utilisions la projection UTM, les unités changeraient.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">repr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/project.html">project</a></span><span class="op">(</span><span class="va">my_rast</span>, <span class="st">"EPSG:26912"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">res</a></span><span class="op">(</span><span class="va">repr</span><span class="op">)</span>
<span class="co">#&gt; [1] 83.5 83.5</span></code></pre></div>
<p>Encore une fois, la commande <code><a href="https://rdrr.io/pkg/terra/man/dimensions.html">res()</a></code> renvoie un tableau numérique sans unité, ce qui nous oblige à savoir que l’unité de la projection UTM est le mètre.</p>
</div>
<div id="ex2" class="section level2" number="2.6">
<h2>
<span class="header-section-number">2.6</span> Exercises<a class="anchor" aria-label="anchor" href="#ex2"><i class="fas fa-link"></i></a>
</h2>
<p>E1. Use <code><a href="https://rdrr.io/pkg/terra/man/summary.html">summary()</a></code> on the geometry column of the <code>world</code> data object that is included in the <strong>spData</strong> package. What does the output tell us about:</p>
<ul>
<li>Its geometry type?</li>
<li>The number of countries?</li>
<li>Its coordinate reference system (CRS)?</li>
</ul>
<p>E2. Run the code that ‘generated’ the map of the world in Section 2.2.3 (Basic map making).
Find two similarities and two differences between the image on your computer and that in the book.</p>
<ul>
<li>What does the <code>cex</code> argument do (see <code><a href="https://rdrr.io/pkg/terra/man/plot.html">?plot</a></code>)?</li>
<li>Why was <code>cex</code> set to the <code>sqrt(world$pop) / 10000</code>?</li>
<li>Bonus: experiment with different ways to visualize the global population.</li>
</ul>
<p>E3. Use <code><a href="https://rdrr.io/pkg/terra/man/plot.html">plot()</a></code> to create maps of Nigeria in context (see Section 2.2.3).</p>
<ul>
<li>Adjust the <code>lwd</code>, <code>col</code> and <code>expandBB</code> arguments of <code><a href="https://rdrr.io/pkg/terra/man/plot.html">plot()</a></code>.</li>
<li>Challenge: read the documentation of <code><a href="https://rdrr.io/pkg/sp/man/gridlines.html">text()</a></code> and annotate the map.</li>
</ul>
<p>E4. Create an empty <code>SpatRaster</code> object called <code>my_raster</code> with 10 columns and 10 rows.
Assign random values between 0 and 10 to the new raster and plot it.</p>
<p>E5. Read-in the <code>raster/nlcd.tif</code> file from the <strong>spDataLarge</strong> package.
What kind of information can you get about the properties of this file?</p>
<p>E6. Check the CRS of the <code>raster/nlcd.tif</code> file from the <strong>spDataLarge</strong> package.
What kind of information you can learn from it?</p>

<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-akima_akima_2016" class="csl-entry">
Akima, Hiroshi, and Albrecht Gebhardt. 2016. <em>Akima: <span>Interpolation</span> of <span>Irregularly</span> and <span>Regularly Spaced Data</span></em>. <a href="https://CRAN.R-project.org/package=akima">https://CRAN.R-project.org/package=akima</a>.
</div>
<div id="ref-baddeley_spatial_2015" class="csl-entry">
Baddeley, Adrian, Ege Rubak, and Rolf Turner. 2015. <em>Spatial Point Patterns: Methodology and Applications with <span>R</span></em>. <span>CRC Press</span>.
</div>
<div id="ref-bivand_using_2000" class="csl-entry">
Bivand, Roger. 2000. <span>“Using the <span>R</span> Statistical Data Analysis Language on <span>GRASS</span> 5.0 <span>GIS</span> Database Files.”</span> <em>Computers &amp; Geosciences</em> 26 (9): 1043–52. <a href="https://doi.org/10.1016/S0098-3004(00)00057-1">https://doi.org/10.1016/S0098-3004(00)00057-1</a>.
</div>
<div id="ref-bivand_more_2001" class="csl-entry">
———. 2001. <span>“More on <span>Spatial Data Analysis</span>.”</span> <em>R News</em> 1 (3): 13–17.
</div>
<div id="ref-hornik_approaches_2003" class="csl-entry">
———. 2003. <span>“Approaches to <span>Classes</span> for <span>Spatial Data</span> in <span>R</span>.”</span> In <em>Proceedings of <span>DSC</span></em>, edited by Kurt Hornik, Friedrich Leisch, and Achim Zeileis. <a href="https://www.r-project.org/nosvn/conferences/DSC-2003/Proceedings/Bivand.pdf">https://www.r-project.org/nosvn/conferences/DSC-2003/Proceedings/Bivand.pdf</a>.
</div>
<div id="ref-bivand_rgrass7_2016" class="csl-entry">
———. 2016a. <em>Rgrass7: <span>Interface Between GRASS</span> 7 <span>Geographical Information System</span> and <span>R</span></em>. <a href="https://CRAN.R-project.org/package=rgrass7">https://CRAN.R-project.org/package=rgrass7</a>.
</div>
<div id="ref-bivand_spgrass6_2016" class="csl-entry">
———. 2016b. <em>Spgrass6: <span>Interface</span> Between <span>GRASS</span> 6 and <span>R</span></em>. <a href="http://CRAN.R-project.org/package=spgrass6">http://CRAN.R-project.org/package=spgrass6</a>.
</div>
<div id="ref-bivand_spdep_2017" class="csl-entry">
———. 2017. <em>Spdep: <span>Spatial Dependence</span>: <span>Weighting Schemes</span>, <span>Statistics</span> and <span>Models</span></em>. <a href="https://CRAN.R-project.org/package=spdep">https://CRAN.R-project.org/package=spdep</a>.
</div>
<div id="ref-bivand_progress_2021" class="csl-entry">
———. 2021. <span>“Progress in the <span>R</span> Ecosystem for Representing and Handling Spatial Data.”</span> <em>Journal of Geographical Systems</em> 23 (4): 515–46. <a href="https://doi.org/ghnwg3">https://doi.org/ghnwg3</a>.
</div>
<div id="ref-bivand_implementing_2000" class="csl-entry">
Bivand, Roger, and Albrecht Gebhardt. 2000. <span>“Implementing Functions for Spatial Statistical Analysis Using the Language.”</span> <em>Journal of Geographical Systems</em> 2 (3): 307–17. <a href="https://doi.org/10.1007/PL00011460">https://doi.org/10.1007/PL00011460</a>.
</div>
<div id="ref-R-rgdal" class="csl-entry">
Bivand, Roger, Tim Keitt, and Barry Rowlingson. 2018. <em>Rgdal: Bindings for the ’Geospatial’ Data Abstraction Library</em>. <a href="https://CRAN.R-project.org/package=rgdal">https://CRAN.R-project.org/package=rgdal</a>.
</div>
<div id="ref-bivand_maptools_2017" class="csl-entry">
Bivand, Roger, and Nicholas Lewin-Koh. 2017. <em>Maptools: <span>Tools</span> for <span>Reading</span> and <span>Handling Spatial Objects</span></em>. <a href="https://CRAN.R-project.org/package=maptools">https://CRAN.R-project.org/package=maptools</a>.
</div>
<div id="ref-bivand_open_2000" class="csl-entry">
Bivand, Roger, and Markus Neteler. 2000. <span>“Open Source Geocomputation: Using the <span>R</span> Data Analysis Language Integrated with <span>GRASS GIS</span> and <span>PostgreSQL</span> Data Base Systems.”</span> In <em>Proceedings of the 5th <span>International Conference</span> on <span>GeoComputation</span></em>, edited by Markus Neteler and Roger S. Bivand. <a href="http://www.geocomputation.org/2000/GC009/Gc009.htm">http://www.geocomputation.org/2000/GC009/Gc009.htm</a>.
</div>
<div id="ref-bivand_applied_2013" class="csl-entry">
Bivand, Roger, Edzer Pebesma, and Virgilio Gómez-Rubio. 2013. <em>Applied Spatial Data Analysis with <span>R</span></em>. Vol. 747248717. <span>Springer</span>. <a href="https://books.google.com?id=v0eIU9ObJXgC">https://books.google.com?id=v0eIU9ObJXgC</a>.
</div>
<div id="ref-R-rgeos" class="csl-entry">
Bivand, Roger, and Colin Rundel. 2018. <em>Rgeos: Interface to Geometry Engine - Open Source (’GEOS’)</em>. <a href="https://CRAN.R-project.org/package=rgeos">https://CRAN.R-project.org/package=rgeos</a>.
</div>
<div id="ref-bondaruk_assessing_2020" class="csl-entry">
Bondaruk, Ben, Steven A. Roberts, and Colin Robertson. 2020. <span>“Assessing the State of the Art in <span>Discrete Global Grid Systems</span>: <span>OGC</span> Criteria and Present Functionality.”</span> <em>Geomatica</em> 74 (1): 9–30. <a href="https://doi.org/10.1139/geomat-2019-0015">https://doi.org/10.1139/geomat-2019-0015</a>.
</div>
<div id="ref-brenning_arcgis_2012" class="csl-entry">
Brenning, Alexander. 2012. <em><span>ArcGIS Geoprocessing</span> in <span>R</span> via <span>Python</span></em>. <a href="https://CRAN.R-project.org/package=RPyGeo">https://CRAN.R-project.org/package=RPyGeo</a>.
</div>
<div id="ref-R-RSAGA" class="csl-entry">
Brenning, Alexander, Donovan Bangs, and Marc Becker. 2018. <em>RSAGA: SAGA Geoprocessing and Terrain Analysis</em>. <a href="https://CRAN.R-project.org/package=RSAGA">https://CRAN.R-project.org/package=RSAGA</a>.
</div>
<div id="ref-brzustowicz_data_2017" class="csl-entry">
Brzustowicz, Michael R. 2017. <em>Data Science with <span>Java</span>: [Practical Methods for Scientists and Engineers]</em>. First. <span>Beijing Boston Farnham</span>: <span>O´Reilly</span>.
</div>
<div id="ref-calenge_package_2006" class="csl-entry">
Calenge, C. 2006. <span>“The Package Adehabitat for the <span>R</span> Software: Tool for the Analysis of Space and Habitat Use by Animals.”</span> <em>Ecological Modelling</em> 197: 1035. <a href="https://doi.org/10.1016/j.ecolmodel.2006.03.017">https://doi.org/10.1016/j.ecolmodel.2006.03.017</a>.
</div>
<div id="ref-chambers_extending_2016" class="csl-entry">
Chambers, John M. 2016. <em>Extending <span>R</span></em>. <span>CRC Press</span>. <a href="https://books.google.com?id=kxxjDAAAQBAJ">https://books.google.com?id=kxxjDAAAQBAJ</a>.
</div>
<div id="ref-cooley_sfheaders_2020" class="csl-entry">
Cooley, David. 2020. <em>Sfheaders: <span>Converts</span> Between r Objects and Simple Feature Objects</em>. Manual. <a href="https://CRAN.R-project.org/package=sfheaders">https://CRAN.R-project.org/package=sfheaders</a>.
</div>
<div id="ref-coppock_history_1991" class="csl-entry">
Coppock, J Terry, and David W Rhind. 1991. <span>“The History of <span>GIS</span>.”</span> <em>Geographical Information Systems: Principles and Applications, Vol. 1.</em> 1 (1): 21–43. <a href="https://www.geos.ed.ac.uk/~gisteac/ilw/generic_resources/books_and_papers/Thx1ARTICLE.pdf">https://www.geos.ed.ac.uk/~gisteac/ilw/generic_resources/books_and_papers/Thx1ARTICLE.pdf</a>.
</div>
<div id="ref-dunnington_ggspatial_2021" class="csl-entry">
Dunnington, Dewey. 2021. <em>Ggspatial: <span>Spatial</span> Data Framework for Ggplot2</em>. Manual. <a href="https://CRAN.R-project.org/package=ggspatial">https://CRAN.R-project.org/package=ggspatial</a>.
</div>
<div id="ref-eddelbuettel_extending_2018" class="csl-entry">
Eddelbuettel, Dirk, and James Joseph Balamuta. 2018. <span>“Extending <span>R</span> with <span>C</span>++: <span>A Brief Introduction</span> to <span>Rcpp</span>.”</span> <em>The American Statistician</em> 72 (1): 28–36. <a href="https://doi.org/gdg3fb">https://doi.org/gdg3fb</a>.
</div>
<div id="ref-garrard_geoprocessing_2016" class="csl-entry">
Garrard, Chris. 2016. <em>Geoprocessing with <span>Python</span></em>. <span>Shelter Island, NY</span>: <span>Manning Publications</span>.
</div>
<div id="ref-gillespie_efficient_2016" class="csl-entry">
Gillespie, Colin, and Robin Lovelace. 2016. <em>Efficient <span>R Programming</span>: <span>A Practical Guide</span> to <span>Smarter Programming</span></em>. <span>O’Reilly Media</span>. <a href="https://csgillespie.github.io/efficientR/">https://csgillespie.github.io/efficientR/</a>.
</div>
<div id="ref-giraud_mapsf_2021" class="csl-entry">
Giraud, Timothée. 2021. <em>Mapsf: <span>Thematic</span> Cartography</em>. Manual. <a href="https://CRAN.R-project.org/package=mapsf">https://CRAN.R-project.org/package=mapsf</a>.
</div>
<div id="ref-grolemund_r_2016" class="csl-entry">
Grolemund, Garrett, and Hadley Wickham. 2016. <em>R for <span>Data Science</span></em>. <span>O’Reilly Media</span>.
</div>
<div id="ref-hijmans_geosphere_2016" class="csl-entry">
Hijmans, Robert J. 2016. <em>Geosphere: <span>Spherical Trigonometry</span></em>. <a href="https://CRAN.R-project.org/package=geosphere">https://CRAN.R-project.org/package=geosphere</a>.
</div>
<div id="ref-R-raster" class="csl-entry">
———. 2017. <em>Raster: Geographic Data Analysis and Modeling</em>. <a href="https://CRAN.R-project.org/package=raster">https://CRAN.R-project.org/package=raster</a>.
</div>
<div id="ref-hijmans_terra_2021" class="csl-entry">
———. 2021. <em>Terra: <span>Spatial</span> Data Analysis</em>. Manual. <a href="https://rspatial.org/terra/">https://rspatial.org/terra/</a>.
</div>
<div id="ref-essd-11-647-2019" class="csl-entry">
Ince, E. S., F. Barthelmes, S. Reißland, K. Elger, C. Förste, F. Flechtner, and H. Schuh. 2019. <span>“<span>ICGEM</span> – 15 Years of Successful Collection and Distribution of Global Gravitational Models, Associated Services, and Future Plans.”</span> <em>Earth System Science Data</em> 11 (2): 647–74. <a href="https://doi.org/gg5tzm">https://doi.org/gg5tzm</a>.
</div>
<div id="ref-jr_geor_2016" class="csl-entry">
Jr, Paulo J. Ribeiro, and Peter J. Diggle. 2016. <em><span class="nocase">geoR</span>: <span>Analysis</span> of <span>Geostatistical Data</span></em>. <a href="https://CRAN.R-project.org/package=geoR">https://CRAN.R-project.org/package=geoR</a>.
</div>
<div id="ref-kahle_ggmap_2013" class="csl-entry">
Kahle, D, and Hadley Wickham. 2013. <span>“Ggmap: <span>Spatial Visualization</span> with Ggplot2.”</span> <em>The R Journal</em> 5: 144–61. <a href="https://doi.org/10.32614/RJ-2013-014">https://doi.org/10.32614/RJ-2013-014</a>.
</div>
<div id="ref-lamigueiro_displaying_2018" class="csl-entry">
Lamigueiro, Oscar Perpinan. 2018. <em>Displaying <span>Time Series</span>, <span>Spatial</span>, and <span>Space-Time Data</span> with <span>R</span></em>. Second. <span>Boca Raton</span>: <span>Chapman and Hall/CRC</span>.
</div>
<div id="ref-livingstone_geographical_1992" class="csl-entry">
Livingstone, David N. 1992. <em>The <span>Geographical Tradition</span>: <span>Episodes</span> in the <span>History</span> of a <span>Contested Enterprise</span></em>. <span>Oxford, UK ; Cambridge, USA</span>: <span>John Wiley &amp; Sons Ltd</span>.
</div>
<div id="ref-loecher_rgooglemaps_2015" class="csl-entry">
Loecher, Markus, and Karl Ropkins. 2015. <span>“<span>RgoogleMaps</span> and Loa: <span>Unleashing R Graphics Power</span> on <span>Map Tiles</span>.”</span> <em>Journal of Statistical Software</em> 63 (February): 1–18. <a href="https://doi.org/gfgwng">https://doi.org/gfgwng</a>.
</div>
<div id="ref-longley_geographic_2015" class="csl-entry">
Longley, Paul. 2015. <em>Geographic Information Science &amp; Systems</em>. Fourth edition. <span>Hoboken, NJ</span>: <span>Wiley</span>.
</div>
<div id="ref-longley_geocomputation_1998" class="csl-entry">
Longley, Paul, Sue M. Brooks, Rachael McDonnell, and Bill MacMillan, eds. 1998. <em>Geocomputation: <span>A Primer</span></em>. <span>Chichester, Eng. ; New York</span>: <span>Wiley</span>.
</div>
<div id="ref-majure_sgeostat_2016" class="csl-entry">
Majure, James J., and Albrecht Gebhardt. 2016. <em>Sgeostat: <span>An Object-Oriented Framework</span> for <span>Geostatistical Modeling</span> in <span>S</span>+</em>. <a href="https://CRAN.R-project.org/package=sgeostat">https://CRAN.R-project.org/package=sgeostat</a>.
</div>
<div id="ref-maling_coordinate_1992" class="csl-entry">
Maling, D. H. 1992. <em>Coordinate Systems and Map Projections</em>. Second. <span>Oxford ; New York</span>: <span>Pergamon Press</span>.
</div>
<div id="ref-_map_1993" class="csl-entry">
<span>“Map Projections.”</span> 1993. <span>US Geological Survey</span>. <a href="https://doi.org/10.3133/70047422">https://doi.org/10.3133/70047422</a>.
</div>
<div id="ref-morganwall_rayshader_2021" class="csl-entry">
Morgan-Wall, Tyler. 2021. <em>Rayshader: <span>Create</span> Maps and Visualize Data in <span>2d</span> and <span>3d</span></em>. Manual. <a href="https://CRAN.R-project.org/package=rayshader">https://CRAN.R-project.org/package=rayshader</a>.
</div>
<div id="ref-muenchow_rqgis:_2017" class="csl-entry">
Muenchow, Jannes, Patrick Schratz, and Alexander Brenning. 2017. <span>“<span>RQGIS</span>: <span>Integrating R</span> with <span>QGIS</span> for Statistical Geocomputing.”</span> <em>The R Journal</em> 9 (2): 409–28. <a href="https://doi.org/gf3d48">https://doi.org/gf3d48</a>.
</div>
<div id="ref-neteler_open_2008" class="csl-entry">
Neteler, Markus, and Helena Mitasova. 2008. <em>Open Source <span>GIS</span>: A <span>GRASS GIS</span> Approach</em>. Third. <span>New York, NY</span>: <span>Springer</span>.
</div>
<div id="ref-openshaw_geocomputation_2000" class="csl-entry">
Openshaw, Stan, and Robert J. Abrahart, eds. 2000. <em>Geocomputation</em>. <span>London ; New York</span>: <span>CRC Press</span>.
</div>
<div id="ref-pebesma_simple_2018" class="csl-entry">
Pebesma, Edzer. 2018. <span>“Simple Features for <span>R</span>: <span>Standardized</span> Support for Spatial Vector Data.”</span> <em>The R Journal</em>. <a href="https://doi.org/gf2ztt">https://doi.org/gf2ztt</a>.
</div>
<div id="ref-pebesma_stars_2021" class="csl-entry">
———. 2021. <em>Stars: <span>Spatiotemporal</span> Arrays, Raster and Vector Data Cubes</em>. Manual. <a href="https://CRAN.R-project.org/package=stars">https://CRAN.R-project.org/package=stars</a>.
</div>
<div id="ref-pebesma_classes_2005" class="csl-entry">
Pebesma, Edzer, and Roger Bivand. 2005. <span>“Classes and Methods for Spatial Data in <span>R</span>.”</span> <em>R News</em> 5 (2): 9–13. <a href="https://cran.r-project.org/doc/Rnews/Rnews_2005-2.pdf">https://cran.r-project.org/doc/Rnews/Rnews_2005-2.pdf</a>.
</div>
<div id="ref-R-sp" class="csl-entry">
———. 2018. <em>Sp: Classes and Methods for Spatial Data</em>. <a href="https://CRAN.R-project.org/package=sp">https://CRAN.R-project.org/package=sp</a>.
</div>
<div id="ref-pebesma_spatial_2022" class="csl-entry">
———. 2022. <em>Spatial <span>Data Science</span> with Applications in <span>R</span></em>. <a href="https://r-spatial.org/book">https://r-spatial.org/book</a>.
</div>
<div id="ref-R-gstat" class="csl-entry">
Pebesma, Edzer, and Benedikt Graeler. 2018. <em>Gstat: Spatial and Spatio-Temporal Geostatistical Modelling, Prediction and Simulation</em>. <a href="https://CRAN.R-project.org/package=gstat">https://CRAN.R-project.org/package=gstat</a>.
</div>
<div id="ref-pebesma_measurement_2016" class="csl-entry">
Pebesma, Edzer, Thomas Mailund, and James Hiebert. 2016. <span>“Measurement <span>Units</span> in <span>R</span>.”</span> <em>The R Journal</em> 8 (2): 486–94. <a href="https://doi.org/gkb5pd">https://doi.org/gkb5pd</a>.
</div>
<div id="ref-pebesma_r_2012" class="csl-entry">
Pebesma, Edzer, Daniel Nüst, and Roger Bivand. 2012. <span>“The <span>R</span> Software Environment in Reproducible Geoscientific Research.”</span> <em>Eos, Transactions American Geophysical Union</em> 93 (16): 163–63. <a href="https://doi.org/gd8djc">https://doi.org/gd8djc</a>.
</div>
<div id="ref-pedersen_gganimate_2020" class="csl-entry">
Pedersen, Thomas Lin, and David Robinson. 2020. <em>Gganimate: <span>A</span> Grammar of Animated Graphics</em>. Manual. <a href="https://CRAN.R-project.org/package=gganimate">https://CRAN.R-project.org/package=gganimate</a>.
</div>
<div id="ref-rcoreteam_introduction_2021" class="csl-entry">
R Core Team, D. M. Smith, and R Core Team. 2021. <em>An <span>Introduction</span> to <span>R</span></em>. <a href="https://cran.r-project.org/doc/manuals/r-release/R-intro.html">https://cran.r-project.org/doc/manuals/r-release/R-intro.html</a>.
</div>
<div id="ref-ripley_spatial_2001" class="csl-entry">
Ripley, Brian D. 2001. <span>“Spatial <span>Statistics</span> in <span>R</span>.”</span> <em>R News</em> 1 (2): 14–15.
</div>
<div id="ref-Roussel2020" class="csl-entry">
Roussel, Jean-Romain, David Auty, Nicholas C. Coops, Piotr Tompalski, Tristan R. H. Goodbody, Andrew Sánchez Meador, Jean-François Bourdon, Florian de Boissieu, and Alexis Achim. 2020. <span>“<span class="nocase">lidR</span>: <span>An</span> r Package for Analysis of Airborne Laser Scanning (<span>ALS</span>) Data.”</span> <em>Remote Sensing of Environment</em> 251 (December): 112061. <a href="https://doi.org/ghddxb">https://doi.org/ghddxb</a>.
</div>
<div id="ref-rowlingson_splancs_1993" class="csl-entry">
Rowlingson, B. S, and P. J Diggle. 1993. <span>“Splancs: <span>Spatial</span> Point Pattern Analysis Code in <span class="nocase">S-plus</span>.”</span> <em>Computers &amp; Geosciences</em> 19 (5): 627–55. <a href="https://doi.org/dvzffd">https://doi.org/dvzffd</a>.
</div>
<div id="ref-rowlingson_rasp:_2003" class="csl-entry">
Rowlingson, Barry, Adrian Baddeley, Rolf Turner, and Peter Diggle. 2003. <span>“Rasp: <span>A Package</span> for <span>Spatial Statistics</span>.”</span> In <em>Proceedings of the 3rd <span>International Workshop</span> on <span>Distributed Statistical Computing</span></em>, edited by Kurt Hornik. <a href="https://www.r-project.org/conferences/DSC-2003/Proceedings/RowlingsonEtAl.pdf">https://www.r-project.org/conferences/DSC-2003/Proceedings/RowlingsonEtAl.pdf</a>.
</div>
<div id="ref-rowlingson_splancs_2017" class="csl-entry">
Rowlingson, Barry, and Peter Diggle. 2017. <em>Splancs: <span>Spatial</span> and <span>Space-Time Point Pattern Analysis</span></em>. <a href="https://CRAN.R-project.org/package=splancs">https://CRAN.R-project.org/package=splancs</a>.
</div>
<div id="ref-sherman_desktop_2008" class="csl-entry">
Sherman, Gary. 2008. <em>Desktop <span>GIS</span>: <span>Mapping</span> the <span>Planet</span> with <span>Open Source Tools</span></em>. <span>Pragmatic Bookshelf</span>.
</div>
<div id="ref-talbert_ancient_2014" class="csl-entry">
Talbert, Richard J. A. 2014. <em>Ancient <span>Perspectives</span>: <span>Maps</span> and <span>Their Place</span> in <span>Mesopotamia</span>, <span>Egypt</span>, <span>Greece</span>, and <span>Rome</span></em>. <span>University of Chicago Press</span>. <a href="https://books.google.com?id=srTbAgAAQBAJ">https://books.google.com?id=srTbAgAAQBAJ</a>.
</div>
<div id="ref-tennekes_elegant_2022" class="csl-entry">
Tennekes, Martijn, and Jakub Nowosad. 2022. <em>Elegant and Informative Maps with Tmap</em>.
</div>
<div id="ref-theeconomist_autonomous_2016" class="csl-entry">
The Economist. 2016. <span>“The Autonomous Car’s Reality Check.”</span> <em>The Economist</em>, 2016. <a href="https://www.economist.com/news/science-and-technology/21696925-building-highly-detailed-maps-robotic-vehicles-autonomous-cars-reality">https://www.economist.com/news/science-and-technology/21696925-building-highly-detailed-maps-robotic-vehicles-autonomous-cars-reality</a>.
</div>
<div id="ref-venables_modern_2002" class="csl-entry">
Venables, W. N., and B. D. Ripley. 2002. <em>Modern <span>Applied Statistics</span> with <span>S</span></em>. Fourth. <span>New York</span>: <span>Springer</span>. <a href="http://www.stats.ox.ac.uk/pub/MASS4">http://www.stats.ox.ac.uk/pub/MASS4</a>.
</div>
<div id="ref-wickham_advanced_2019" class="csl-entry">
Wickham, Hadley. 2019. <em>Advanced <span>R</span>, <span>Second Edition</span></em>. <span>CRC Press</span>. <a href="https://adv-r.hadley.nz/">https://adv-r.hadley.nz/</a>.
</div>
<div id="ref-wulf_invention_2015" class="csl-entry">
Wulf, Andrea. 2015. <em>The Invention of Nature: <span>Alexander</span> von <span>Humboldt</span>’s New World</em>. <span>New York</span>: <span>Alfred A. Knopf</span>.
</div>
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>
The conference took place at the University of Leeds, where one of the authors (Robin) is currently based.
The 21<sup>st</sup> GeoComputation conference was also hosted at the University of Leeds, during which Robin and Jakub presented, led a workshop on ‘tidy’ spatial data analysis and collaborated on the book (see www.geocomputation.org for more on the conference series, and papers/presentations spanning two decades).<a href="intro.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>
A laptop with 4GB running a modern operating system such as Ubuntu 16.04 onward should also be able to reproduce the contents of this book.
A laptop with this specification or above can be acquired second-hand for ~US$100 in many countries nowadays, reducing the financial/hardware barrier to geocomputation far below the levels in operation in the early 2000s, when high-performance computers were unaffordable for most people.<a href="intro.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>
Python modules providing access to geoalgorithms include <code>grass.script</code> for GRASS,
<code>saga-python</code> for SAGA-GIS,
<code>processing</code> for QGIS and <code>arcpy</code> for ArcGIS.<a href="intro.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>
An overview of R’s spatial ecosystem can be found in the CRAN Task View on the Analysis of Spatial Data
(see <a href="https://cran.r-project.org/web/views/Spatial.html" class="uri">https://cran.r-project.org/web/views/Spatial.html</a>).<a href="intro.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Note the difference between “r-spatial”, organization containing packages such as <strong>sf</strong>, and “rspatial”, organization responsible for <strong>terra</strong>.<a href="intro.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>
<strong>spDataLarge</strong> n’est pas sur le CRAN, ce qui signifie qu’il doit être installé via <em>r-universe</em> ou avec la commande suivante : <code>remotes::install_github("Nowosad/spDataLarge")</code>.<a href="spatial-class.html#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>
L’origine à laquelle nous faisons référence, représentée en bleu sur la figure <a href="spatial-class.html#fig:vectorplots">2.1</a>, est en fait la “fausse” origine.
L’origine ” réelle “, c’est-à-dire l’endroit où les distorsions sont minimales, est située à 2° W et 49° N.
Cette origine a été choisie par l’<em>Ordnance Survey of the United States</em> afin de se situer approximativement au centre de la masse continentale britannique dans le sens longitudinal.<a href="spatial-class.html#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>
Le format OGC complet comprend des types de géométrie plutôt exotiques, notamment les types de géométrie “surface” et “courbe”, qui ont actuellement une application limitée dans le monde réel.
Les 18 types peuvent être manipulés avec le package <strong>sf</strong>, bien que (à partir de l’été 2018) leur représentation ne fonctionne plus que pour les “7 principaux”.<a href="spatial-class.html#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p>
L’appel de la fonction <code><a href="https://rdrr.io/pkg/terra/man/plot.html">plot()</a></code> sur un objet <strong>sf</strong> va en réalité appeler <code>sf::::plot.sf()</code>.
La fonction <code><a href="https://rdrr.io/pkg/terra/man/plot.html">plot()</a></code> est une méthode géneique qui se comporte différemment selon la classe de l’objet en entré.<a href="spatial-class.html#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>
Remarque : de nombreux arguments de <code><a href="https://rdrr.io/pkg/terra/man/plot.html">plot()</a></code> sont ignorés dans les cartes à facettes, lorsque plus d’une colonne <code>sf</code> est utilisée.<a href="spatial-class.html#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>
Par définition, un polygone a une limite extérieure (anneau extérieur) et peut avoir zéro ou plusieurs limites intérieures (anneaux intérieurs), également appelées “trous”.
Un polygone avec un trou serait, par exemple, <code>POLYGON ((1 5, 2 2, 4 1, 4 4, 1 5), (2 4, 3 4, 3 3, 2 3, 2 4))</code>.<a href="spatial-class.html#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p>
D’autres attributs pourraient être des types de villes (grandes, moyennes), ou une remarque indiquant si la mesure est produit par une station automatique.<a href="spatial-class.html#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p>
Selon le format de fichier, l’en-tête fait partie du fichier de données d’image proprement dit, par exemple GeoTIFF, ou peut-être stocké dans un fichier d’en-tête supplémentaire un <em>world file</em>, par exemple dans les formats de grille ASCII.
Il existe également le format raster binaire sans en-tête (plat) qui devrait faciliter l’importation dans divers logiciels.<a href="spatial-class.html#fnref13" class="footnote-back">↩︎</a></p></li>
<li id="fn14"><p>Il possède également une classe supplémentaire <code>SpatRasterDataset</code> pour stocker de nombreuses collections de jeux de données<a href="spatial-class.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>Les opérateurs <code>[[</code> et <code>$</code> peuvent également être utilisés pour la sélection des couches<a href="spatial-class.html#fnref15" class="footnote-back">↩︎</a></p></li>
<li id="fn16"><p>
Le degré de compression est souvent appelé <em>aplatissement</em>, défini en fonction du rayon équatorial (<span class="math inline">\(a\)</span>) et du rayon polaire (<span class="math inline">\(b\)</span>) comme suit : <span class="math inline">\(f = (a - b) / a\)</span>. Les termes <em>ellipticité</em> et <em>compression</em> peuvent également être utilisés.
Comme <span class="math inline">\(f\)</span> est une valeur plutôt faible, les modèles numériques d’ellipsoïdes utilisent l’“aplatissement inverse” (<span class="math inline">\(rf = 1/f\)</span>) pour définir la compression de la Terre.
Les valeurs de <span class="math inline">\(a\)</span> et <span class="math inline">\(rf\)</span> dans divers modèles ellipsoïdaux peuvent être vues en exécutant <code>sf_proj_info(type = "ellps")</code>.<a href="spatial-class.html#fnref16" class="footnote-back">↩︎</a></p></li>
<li id="fn17"><p>Veuillez noter que le géoïde de la figure exagère la surface bosselée du géoïde par un facteur de 10 000 afin de souligner la forme irrégulière de la planète<a href="spatial-class.html#fnref17" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="intro.html"><span class="header-section-number">1</span> Introduction</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <h2>Note: Second Edition is under construction 🏗</h2>
    <p>Now is a great time to test in-development packages and provide feedback</p>
        <ul class="list-unstyled">
<li><a href="https://forms.gle/nq9RmbxJyZXQgc948">Provide feedback (5 min)</a></li>
          <li><a href="https://geocompr.robinlovelace.net/#reproducibility">Install updated packages</a></li>
          <li><a href="https://github.com/Robinlovelace/geocompr/issues">Open an issue <i class="fas fa-question"></i></a></li>
          <li><a href="https://discord.gg/Te3gWeDwmf">Chat on Discord <i class="fab fa-discord"></i></a></li>
        </ul>
<hr>
<nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#spatial-class"><span class="header-section-number">2</span> La donnée géographique dans R</a></li>
<li><a class="nav-link" href="#pr%C3%A9requis">Prérequis</a></li>
<li><a class="nav-link" href="#intro-spatial-class"><span class="header-section-number">2.1</span> Introduction</a></li>
<li>
<a class="nav-link" href="#donn%C3%A9es-vectorielles"><span class="header-section-number">2.2</span> Données vectorielles</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#une-introduction-aux-simple-features"><span class="header-section-number">2.2.1</span> Une introduction aux Simple Features</a></li>
<li><a class="nav-link" href="#pourquoi-simple-features"><span class="header-section-number">2.2.2</span> Pourquoi simple features?</a></li>
<li><a class="nav-link" href="#basic-map"><span class="header-section-number">2.2.3</span> Réalisation rapide de cartes</a></li>
<li><a class="nav-link" href="#geometry"><span class="header-section-number">2.2.4</span> Les types de geométries</a></li>
<li><a class="nav-link" href="#sf"><span class="header-section-number">2.2.5</span> The sf class</a></li>
<li><a class="nav-link" href="#sfg"><span class="header-section-number">2.2.6</span> Simple feature geometries (sfg)</a></li>
<li><a class="nav-link" href="#sfc"><span class="header-section-number">2.2.7</span> Simple feature columns (sfc)</a></li>
<li><a class="nav-link" href="#le-pacquet-sfheaders"><span class="header-section-number">2.2.8</span> le pacquet sfheaders</a></li>
<li><a class="nav-link" href="#s2"><span class="header-section-number">2.2.9</span> géométrie sphérique avec S2</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#donn%C3%A9es-raster"><span class="header-section-number">2.3</span> Données Raster</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#les-paquets-de-r-pour-travailler-avec-des-rasters"><span class="header-section-number">2.3.1</span> Les paquets de R pour travailler avec des rasters</a></li>
<li><a class="nav-link" href="#une-introduction-%C3%A0-terra"><span class="header-section-number">2.3.2</span> Une introduction à terra</a></li>
<li><a class="nav-link" href="#basic-map-raster"><span class="header-section-number">2.3.3</span> Réalisation de cartes de base</a></li>
<li><a class="nav-link" href="#raster-classes"><span class="header-section-number">2.3.4</span> Les classes Raster</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#crs-intro"><span class="header-section-number">2.4</span> Système de Coordonnés et de Réferences géographiques et projetés</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#syst%C3%A8me-de-r%C3%A9f%C3%A9rence-des-coordonn%C3%A9es"><span class="header-section-number">2.4.1</span> Système de référence des coordonnées</a></li>
<li><a class="nav-link" href="#syst%C3%A8me-de-r%C3%A9ference-projet%C3%A9es"><span class="header-section-number">2.4.2</span> Système de réference projetées</a></li>
</ul>
</li>
<li><a class="nav-link" href="#unit%C3%A9s"><span class="header-section-number">2.5</span> Unités</a></li>
<li><a class="nav-link" href="#ex2"><span class="header-section-number">2.6</span> Exercises</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/geocompr/fr/blob/main/02-spatial-data.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/geocompr/fr/edit/main/02-spatial-data.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Geocomputation avec R</strong>" was written by Robin Lovelace, Jakub Nowosad, Jannes Muenchow. It was last built on 2022-02-25.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
